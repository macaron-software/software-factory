{
  "approved": false,
  "issues": [
    {
      "rule": "INCOMPLET",
      "severity": "reject",
      "points": 5,
      "message": "Code tronqué - security-guards.spec.ts se termine abruptement avec 'await page' incomplet. Le test 'should handle page reload gracefully' n'est jamais terminé.",
      "line": 89
    },
    {
      "rule": "FLAKY_TEST",
      "severity": "warning",
      "points": 2,
      "message": "waitForTimeout(3000) dans chaque test rend les tests lents et flaky. Devrait utiliser waitForCondition ou expects with polling instead.",
      "line": 8
    },
    {
      "rule": "FLAKY_TEST",
      "severity": "warning",
      "points": 2,
      "message": "waitForTimeout(3000) pattern répété - 6 occurrences dans le fichier.",
      "line": 23
    },
    {
      "rule": "FLAKY_TEST",
      "severity": "warning",
      "points": 2,
      "message": "waitForTimeout(3000) pattern répété - 6 occurrences.",
      "line": 38
    },
    {
      "rule": "FLAKY_TEST",
      "severity": "warning",
      "points": 2,
      "message": "waitForTimeout(3000) pattern répété - 6 occurrences.",
      "line": 52
    },
    {
      "rule": "FLAKY_TEST",
      "severity": "warning",
      "points": 2,
      "message": "waitForTimeout(3000) pattern répété - 6 occurrences.",
      "line": 66
    },
    {
      "rule": "FLAKY_TEST",
      "severity": "warning",
      "points": 2,
      "message": "waitForTimeout(3000) pattern répété - 6 occurrences.",
      "line": 80
    },
    {
      "rule": "SECURITY_BYPASS",
      "severity": "warning",
      "points": 1,
      "message": "Regex-based SQL injection patterns peuvent être contournées avec des techniques d'obfuscation. Une validation plus robuste serait meilleure.",
      "line": 140
    }
  ],
  "reasoning": "Code rejeté: fichier test incomplet (tronqué ligne 89), patterns waitForTimeout(3000) répétés 6x = tests flaky/lents. Les regex SQL injection sont basiques."
}
