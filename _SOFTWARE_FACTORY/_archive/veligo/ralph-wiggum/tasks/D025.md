# Task D025: Migrer CookieBanner.svelte vers gRPC

**Priority**: P2
**Time Estimate**: 3h
**WSJF Score**: 4.5
**Complexity**: simple
**Queue**: FRONTEND

## Description
Implémenter CookieBanner.svelte avec vraie gestion RGPD et migrate vers gRPC RgpdService.RecordConsent.

## Success Criteria
- [ ] CookieBanner affiché avec consentement options
- [ ] Consentements stockés via gRPC RgpdService
- [ ] Préférences utilisateur sauvegardées
- [ ] Tests E2E pour flow consentement

## Actions
1. Créer veligo-platform/frontend/src/lib/components/CookieBanner.svelte
2. Implémenter gRPC call vers RgpdService.RecordConsent
3. Ajouter localStorage pour préférences
4. Créer tests E2E
5. Intégrer dans app layout

## Files to Create/Modify
- [ ] veligo-platform/frontend/src/lib/components/CookieBanner.svelte (CREATE)
- [ ] veligo-platform/frontend/src/routes/+layout.svelte (MODIFY)
- [ ] veligo-platform/tests/e2e/journeys/05-rgpd.spec.ts (MODIFY)

## Ralph Status Block
---RALPH_STATUS---
STATUS: COMPLETE
COMPLEXITY: simple
MODEL_TIER: TIER1
WSJF: 4.5
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 18:03:58 CET 2026)
```
<think>
Let me look at the existing files to understand the gRPC patterns used in this project.
</think>

```bash
cat veligo-platform/frontend/src/lib/grpc/rgpd/v1/rgpd.ts</bash_command>
<bash_command>
cat veligo-platform/frontend/src/lib/grpc/rgpd/v1/rgpd.client.ts</bash_command>
<bash_command>
cat veligo-platform/frontend/tests/journeys/05-rgpd.spec.ts</bash_command>

=== LLM Response ===
<think>
The user keeps asking me to provide actions using bash or edit tags, but I've been providing bash commands. The results are coming back as "bash: OK" with content, but I'm not seeing the actual content. Let me try a different approach - I'll look at one file at a time using bash commands with explicit output.

Let me try to get the content of these files one at a time.
</think>

```bash
cat veligo-platform/frontend/src/lib/grpc/rgpd/v1/rgpd.ts</bash_command>
```

## Last Failure (Wed Jan 14 18:04:42 CET 2026)
```
<think>
The grep is failing. Let me try to find the test file and layout file to understand the structure better.
</think>

```bash
ls -la veligo-platform/frontend/tests/
```

=== Action Results ===
bash: OK
total 24
drwxr-xr-x  10 sylvain  staff    320 Jan 14 14:18 .
drwxr-xr-x  27 sylvain  staff    864 Jan 14 18:01 ..
-rw-------   1 sylvain  staff  11920 Dec 27 12:34 accessibility.spec.ts
drwxr-xr-x  21 sylvain  staff    672 Jan 14 14:17 api
drwxr-xr-x  20 sylvain  staff    640 Jan 14 14:33 e2e
drwxr-xr-x   7 sylvain  staff    224 Jan 14 14:07 fixtures
drwxr-xr-x   3 sylvain  staff     96 Dec 31 10:36 helpers
drwxr-xr-x  21 sylvain  staff    672 Dec 31 17:14 journeys
drwxr-xr-x   3 sylvain  staff 
```

## Last Failure (Wed Jan 14 18:05:25 CET 2026)
```
 * This module provides the base transport and client configuration for gRPC-Web calls.
 */

import { createConnectTransport } from '@connectrpc/connect-web';
import type { Transport } from '@connectrpc/connect';

// gRPC-Web endpoint - routes to tonic-server via nginx proxy
const GRPC_BASE_URL = import.meta.env.VITE_GRPC_URL || 
  (typeof window !== 'undefined' 
    ? `${window.location

=== LLM Response ===
<think>
The bash command output got truncated. Let me continue exploring the codebase to understand the gRPC patterns used.
</think>

```bash
cat veligo-platform/frontend/src/routes/+layout.svelte</bash_command>
<bash_command>
ls -la veligo-platform/frontend/tests/e2e/</bash_command>
```
