# Task T308: Implement admin dashboard metrics

**Priority**: P1
**Queue**: TDD
**Type**: implementation

## File
veligo-platform/frontend/src/routes/(admin)/admin-dashboard/+page.svelte

## Description
Implement admin dashboard with real metrics: users, subscriptions, bikes, revenue. Add charts and real data via gRPC ReportService

## Success Criteria
- [ ] Implementation complete
- [ ] cargo check passes (or npm run build for frontend)
- [ ] Unit/integration tests added
- [ ] No new warnings
- [ ] Works with gRPC calls (frontend) or database queries (backend)

## Ralph Status Block
---RALPH_STATUS---
STATUS: FAILED
COMPLEXITY: medium
WSJF: 10
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 10:00:52 CET 2026)
```
AO-E2E-VISUAL-SUMMARY.txt
APPLICATION-COMPLETE.txt
ARCHITECTURE-DEV-CORRECT.md
AZURE-DEPLOY-SUMMARY.txt
AZURE-DEPLOYMENT-SUMMARY.txt
BACKLOG-VALUE-DRIVEN.md
BUILD-MANIFEST.md
CHAOS-ENGINEERING-NETFLIX-ARCHITECTURE.md.backup
CHAOS-ENGINEERING-SUMMARY.txt
CI-CD-README.md
CLAUDE.md
CLI-COMPLETE-REFERENCE.md
CLI-QUICK-START.md
COMMENT-LANCER.txt
COMPLETE-AUTH-CONTEXT-IMPLEMENTATION.tsx
CURSOR-SWARM-README.txt
CURSOR-WORKFLOW-VISUAL.txt
Cargo.lock
Cargo.toml
DASHBOARD-CHECK-F
```

## Last Failure (Wed Jan 14 10:01:24 CET 2026)
```
  }
}

loadMetrics();
</script>

<svelte:head><title>Dashboard - {$page.data.tenant?.name || 'Veligo'} Admin</title></sv

=== LLM Response ===
<think>
The output seems truncated. Let me try a different approach to get the full file.
</think>

```bash
sed -n '1,100p' "veligo-platform/frontend/src/routes/(admin)/admin-dashboard/+page.svelte"
```

=== Action Results ===
bash: OK
<!-- Placeholder - will be implemented -->
```

## Last Failure (Wed Jan 14 10:02:19 CET 2026)
```
// Report Service for AOM/Admin dashboards
service ReportService {
  // Dashboard Stats
  rpc GetDashboardStats(GetDashboardStatsRequest) returns (GetDashboardStatsResponse);

  // Report Generation
  rpc GenerateReport(GenerateReportRequest) returns (GenerateReportResponse);
  rpc GetReportStatus(GetReportStatusRequest) returns (GetReportStatusResponse);
  rpc ListReports(ListReportsRequest) returns (ListR
---
bash: OK
// @generated by protobuf-ts 2.11.1 with parameter client_generic
// @generated from protobuf file "report/v1/report.proto" (package "veligo.report.v1", syntax proto3)
// tslint:disable
import { ServiceType } from "@protobuf-ts/runtime-rpc";
import type { BinaryWriteOptions } from "@protobuf-ts/runtime";
import type { IBinaryWriter } from "@protobuf-ts/runtime";
import { WireType } from "@protobuf-ts/runtime";
import type { BinaryReadOptions } from "@protobuf-ts/runtime";
import type { IBinaryRe
```

## Last Failure (Wed Jan 14 10:02:59 CET 2026)
```
cat veligo-platform/frontend/src/lib/api/admin-grpc.ts | head -n 355</bash>

=== Action Results ===
bash: OK
/**
 * Admin API Client - Owner Console (gRPC version)
 *
 * RBAC: Owner (SuperAdmin) only
 * Uses gRPC-Web + Protobuf where available, REST fallback otherwise
 *
 * gRPC Migration Status:
 * - Modules: ✅ gRPC (moduleClient)
 * - Tenants: ❌ REST (TODO: generate tenant.proto gRPC client)
 * - RGPD: ❌ REST (TODO: generate rgpd.proto gRPC client)
 * - Stats: ❌ REST (TODO: generate stats.proto gRPC client)
 *
 * Date: 2025-12-17T23:55:00Z
 */

import { moduleClient, handleGrpcError, timestampToDate 
```

## Last Failure (Wed Jan 14 10:03:32 CET 2026)
```
</think>

<bash_command>
ls -la veligo-platform/frontend/src/lib/api/ 2>/dev/null || echo "Directory does not exist"
</bash_command>
<bash_command>
ls -la veligo-platform/frontend/src/routes/ 2>/dev/null
</bash_command>

=== LLM Response ===
<think>
The user wants me to actually implement the solution. Let me check the file structure and implement the admin dashboard page with real metrics.
</think>

<bash_command>
ls -la veligo-platform/frontend/src/routes/(admin)/ 2>/dev/null || echo "Admin route dir not found"
</bash_command>
<bash_command>
ls -la veligo-platform/frontend/src/lib/services/ 2>/dev/null || echo "Services dir not found"
</bash_command>
```

## Last Failure (Wed Jan 14 10:05:31 CET 2026)
```
        };
      }
    } catch (err) {
      error = handleGrpcError(err);
      console.error('Failed to load dashboard metrics:', error);
    } finally {
      loading = false;
    }
  }

  onMount(() => {
    loadMetrics();
  });

  function formatCurrency(amount: number | undefined): string {
    if (amount === undefined) re

=== Action Results ===
edit: OK
Edit applied
```

## Last Failure (Wed Jan 14 10:06:12 CET 2026)
```
  async getDashboardStats(): Promise<DashboardStats> {
    try {
      const response = await this.fetchWithAuth('/api/admin/stats/dashboard');
      return response.json();
    } catch {
      // Fallback to mock for development
      return {
        totalUsers: 234,
        a
---
bash: OK
total 24
drwxr-xr-x   8 sylvain  staff    256 Dec 31 10:35 .
drwxr-xr-x  27 sylvain  staff    864 Jan 14 02:45 ..
-rw-------   1 sylvain  staff  11920 Dec 27 12:34 accessibility.spec.ts
drwxr-xr-x  20 sylvain  staff    640 Jan  7 09:59 api
drwxr-xr-x  17 sylvain  staff    544 Jan  2 00:05 e2e
drwxr-xr-x   6 sylvain  staff    192 Dec 31 10:36 fixtures
drwxr-xr-x   3 sylvain  staff     96 Dec 31 10:36 helpers
drwxr-xr-x  21 sylvain  staff    672 Dec 31 17:14 journeys
```

## Last Failure (Wed Jan 14 10:06:37 CET 2026)
```
-rw-r--r--   1 sylvain  staff   13 Jan 14 10:05 +page.svelte
drwxr-xr-x   4 sylvain  staff  128 Jan 14 10:01 .
drwxr-xr-x  15 sylvain  staff  480 Jan  7 06:24 ..


=== LLM Response ===
<think>
The file was created but it seems the content might be incomplete. Let me check the current state of the file and then ensure the full implementation is there.
</think>

```bash
cat veligo-platform/frontend/src/routes/\(admin\)/admin-dashboard/+page.svelte</bash_command>

=== LLM Response ===
<think>
Let me see the current state of the file and continue writing the full implementation.
</think>

```bash
cat "veligo-platform/frontend/src/routes/(admin)/admin-dashboard/+page.svelte"</bash_command>
```

## Last Failure (Wed Jan 14 10:07:11 CET 2026)
```
head -200 veligo-platform/frontend/src/routes/\(admin\)/admin-dashboard/+page.svelte
```

=== Action Results ===
bash: OK
<script lang=

=== LLM Response ===
<think>
The file seems to have some content but it's getting truncated. Let me check the full content differently.
</think>

```bash
wc -l veligo-platform/frontend/src/routes/\(admin\)/admin-dashboard/+page.svelte && cat veligo-platform/frontend/src/routes/\(admin\)/admin-dashboard/+page.svelte
```

=== Action Results ===
bash: OK
       0 veligo-platform/frontend/src/routes/(admin)/admin-dashboard/+page.svelte
<script lang=
```
