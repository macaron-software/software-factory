# Task T107: Add missing data-testid: +page.svelte

**Priority**: P1
**Queue**: TDD
**AO_REF**: AO-IDFM-AUTH

## Description
FranceConnect component missing data-testid='franceconnect-login'

## File
veligo-platform/frontend/src/routes/login/+page.svelte:0

## Success Criteria
- [ ] Issue fixed
- [ ] Code compiles
- [ ] Tests pass
- [ ] No regressions

## Ralph Status Block
---RALPH_STATUS---
STATUS: COMPLETED
COMPLEXITY: simple
WSJF: 8
---END_RALPH_STATUS---

## Last Failure (Tue Jan 13 18:38:48 CET 2026)
```
bash: OK
veligo-platform/frontend/src/lib/auth/franceconnect.ts:2: * FranceConnect Authentication Module
veligo-platform/frontend/src/lib/auth/franceconnect.ts:4: * Handles OAuth2 flow with FranceConnect identity provider.
veligo-platform/frontend/src/lib/auth/franceconnect.ts:9:export interface FranceConnectAuthResponse {
veligo-platform/frontend/src/lib/auth/franceconnect.ts:14:export interface FranceConnectCallbackResponse {
veligo-platform/frontend/src/lib/auth/franceconnect.ts:28:export interface Fr

=== LLM Response ===
<think>
The FranceConnect component isn't directly used in the login page, but it's imported from @velino/svelte-ui. Let me search for where it might be used or check if there's a different file. Let me also search more broadly for the component usage.
</think>

<bash>
grep -rn "import.*FranceConnect" veligo-platform/frontend/src/
</bash>

=== Action Results ===
bash: OK
veligo-platform/frontend/src/lib/hooks/examples/registerFranceConnect.ts:8: *   import { initFranceConnectModule } from '$lib/hooks/examples/registerFranceConnect';
veligo-platform/frontend/src/lib/hooks/examples/registerFranceConnect.ts:13:import FranceConnectButton from './FranceConnectButton.svelte';
```

## Last Failure (Tue Jan 13 18:39:16 CET 2026)
```
<bash>
grep -n "social\|provider\|button" veligo-platform/frontend/src/routes/login/+page.svelte | head -30
</bash>

=== Action Results ===
bash: OK
36:  provider: 'google' | 'franceconnect';
201:  const provider = urlParams.get('provider') as 'google' | 'franceconnect' | null;
204:  if (!provider || !code) {
212:    body: JSON.stringify({ provider, code })
299:        <button
305:        </button>
347:        <button
353:        </button>
422:        <button
428:        </button>
446:        <button
452:        </button>
482:        <button
488:        </button>
```

## Last Failure (Tue Jan 13 18:39:41 CET 2026)
```
</think>

<bash>
grep -n "data-testid" veligo-platform/frontend/src/routes/login/+page.svelte
</bash>

=== Action Results ===
bash: OK
280:            data-testid="login-email"
292:            data-testid="login-password"
301:          data-testid="login-submit"
316:            data-testid="register-name"
328:            data-testid="register-email"
340:            data-testid="register-password"
349:          data-testid="register-submit"
364:            data-testid="signup-name"
376:            data-testid="signup-email"
388:            data-testid="signup-password"
424:          data-testid="signup-submit"
439:            da
```

## Last Failure (Wed Jan 14 08:27:15 CET 2026)
```
=== Action Results ===
bash: OK
36:  provider: 'google' | 'franceconnect';
201:  const provider = urlParams.get('provider') as 'google' | 'franceconnect' | null;
204:  if (!provider || !code) {
212:    body: JSON.stringify({ provider, code })


=== LLM Response ===
<think>
Let me look for how social login buttons are rendered in this file. Let me look at the full file more carefully.
</think>

<bash>
wc -l veligo-platform/frontend/src/routes/login/+page.svelte
</bash>

=== Action Results ===
bash: OK
     499 veligo-platform/frontend/src/routes/login/+page.svelte
```

## Last Failure (Wed Jan 14 08:27:47 CET 2026)
```
201:  const provider = urlParams.get('provider') as 'google' | 'franceconnect' | null;
204:  if (!provider || !code) {
212:    body: JSON.stringify({ provider, code })


=== LLM Response ===
<think>
It seems like the social login buttons (including FranceConnect) might be somewhere else or not in this file yet. Let me look at the full file more carefully to understand the structure. Let me check if there are other login-related files or components.
</think>

<bash>
grep -rn "franceconnect-login\|franceconnect" veligo-platform/frontend/src/
</bash>

=== Action Results ===
bash: OK
veligo-platform/frontend/src/lib/auth/franceconnect.ts:38:  const response = await fetch(`${API_BASE}/api/auth/franceconnect/authorize`, {
veligo-platform/frontend/src/lib/auth/franceconnect.ts:75:  const response = await fetch(`${API_BASE}/api/auth/franceconnect/callback`, {
veligo-platform/frontend/src/lib/auth/franceconnect.ts:173:      await fetch(`${API_BASE}/api/auth/franceconnect/logout`, {
veligo-platform/frontend/src/lib/components/FranceConnectButton.svelte:8:     * @param provider The
```

## Last Failure (Wed Jan 14 08:28:50 CET 2026)
```
I found it! The FranceConnectButton component already has `data-testid="franceconnect-login"` on line 25. But the issue is that this component might not be used in the login page. Let me check if it's imported in the login page.

The issue says the FranceConnect component is missing the data-testid. Let me check if LoginWidget is being used or if the FranceConnectButton should be added to the login page.
</think>

<bash>
grep -n "LoginWidget\|FranceConnectButton\|franceconnect" veligo-platform/frontend/src/routes/login/+page.svelte
</bash>
<bash>
grep -rn "import.*LoginWidget" veligo-platform/frontend/src/routes/
</bash>

=== Action Results ===
bash: OK
36:  provider: 'google' | 'franceconnect';
201:  const provider = urlParams.get('provider') as 'google' | 'franceconnect' | null;
224:  if (pagePath === '/auth/callback' || pagePath === '/auth/franceconnect/callback') {

---
bash: FAIL
```

## Last Failure (Wed Jan 14 08:33:32 CET 2026)
```
  password: string;
}

interface RegisterForm {
  name: string;
  email: string;
  password: string;
}

interface SignupForm {
  name: string;
  email: string;
  password: string;
  plan: 'free' | 'premium';
}

interface ResetForm {
  ema

ERROR: LLM call failed
```

## Last Failure (Wed Jan 14 08:33:32 CET 2026)
```
  password: string;
}

interface RegisterForm {
  name: string;
  email: string;
  password: string;
}

interface SignupForm {
  name: string;
  email: string;
  password: string;
  plan: 'free' | 'premium';
}

interface ResetForm {
  ema

ERROR: LLM call failed
```

## Last Failure (Wed Jan 14 08:33:38 CET 2026)
```
[0;32m[AGENT] Real Agent starting[0m
[0;34m[AGENT] Task: /Users/sylvain/_LAPOSTE/_VELIGO2/tools/ralph-wiggum/tasks/T107.md[0m
[0;34m[AGENT] Queue: tdd[0m
[0;34m[AGENT] Backend: local[0m
[0;32m[AGENT] Starting task: T107[0m
[0;34m[AGENT] Iteration 1/10[0m
[0;31m[AGENT] Local LLM failed: HTTPConnectionPool(host='127.0.0.1', port=8002): Max retries exceeded with url: /v1/chat/completions (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x106cd8590>: Failed to establish a new connection: [Errno 61] Connection refused'))[0m

============================================================
RESULT: FAILED
============================================================
ERROR: LLM call failed
```

## Last Failure (Wed Jan 14 08:33:38 CET 2026)
```
[0;32m[AGENT] Real Agent starting[0m
[0;34m[AGENT] Task: /Users/sylvain/_LAPOSTE/_VELIGO2/tools/ralph-wiggum/tasks/T107.md[0m
[0;34m[AGENT] Queue: tdd[0m
[0;34m[AGENT] Backend: local[0m
[0;32m[AGENT] Starting task: T107[0m
[0;34m[AGENT] Iteration 1/10[0m
[0;31m[AGENT] Local LLM failed: HTTPConnectionPool(host='127.0.0.1', port=8002): Max retries exceeded with url: /v1/chat/completions (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x106f54590>: Failed to establish a new connection: [Errno 61] Connection refused'))[0m

============================================================
RESULT: FAILED
============================================================
ERROR: LLM call failed
```

## Last Failure (Wed Jan 14 08:33:44 CET 2026)
```
[0;32m[AGENT] Real Agent starting[0m
[0;34m[AGENT] Task: /Users/sylvain/_LAPOSTE/_VELIGO2/tools/ralph-wiggum/tasks/T107.md[0m
[0;34m[AGENT] Queue: tdd[0m
[0;34m[AGENT] Backend: local[0m
[0;32m[AGENT] Starting task: T107[0m
[0;34m[AGENT] Iteration 1/10[0m
[0;31m[AGENT] Local LLM failed: HTTPConnectionPool(host='127.0.0.1', port=8002): Max retries exceeded with url: /v1/chat/completions (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x106dc4590>: Failed to establish a new connection: [Errno 61] Connection refused'))[0m

============================================================
RESULT: FAILED
============================================================
ERROR: LLM call failed
```

## Last Failure (Wed Jan 14 08:33:44 CET 2026)
```
[0;32m[AGENT] Real Agent starting[0m
[0;34m[AGENT] Task: /Users/sylvain/_LAPOSTE/_VELIGO2/tools/ralph-wiggum/tasks/T107.md[0m
[0;34m[AGENT] Queue: tdd[0m
[0;34m[AGENT] Backend: local[0m
[0;32m[AGENT] Starting task: T107[0m
[0;34m[AGENT] Iteration 1/10[0m
[0;31m[AGENT] Local LLM failed: HTTPConnectionPool(host='127.0.0.1', port=8002): Max retries exceeded with url: /v1/chat/completions (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10a780590>: Failed to establish a new connection: [Errno 61] Connection refused'))[0m

============================================================
RESULT: FAILED
============================================================
ERROR: LLM call failed
```
