# Task T141: Create E2E Journey - subscriber-onboarding

**Priority**: P1
**Queue**: TDD
**AO_REF**: AO-NANTES-JOURNEY
**Tenant**: nantes

## Description
Missing E2E journey: subscriber-onboarding - New Naolib user registration

Journey: New Naolib user registration

## File to Create
tests/e2e/journeys/nantes-subscriber-onboarding.spec.ts

## Test Template
```typescript
import { test, expect } from '@playwright/test';
import { users } from '../fixtures/users.json';
import { stations } from '../fixtures/stations.json';

const BASE_URL = process.env.NANTES_URL || 'https://nantes.veligo.app';

test.describe('[AO-NANTES-JOURNEY] subscriber-onboarding', () => {

  test('Complete subscriber-onboarding journey', async ({ page }) => {
    // Step 1: Navigate to starting point
    await page.goto(`${BASE_URL}/`);

    // Step 2: User actions
    // TODO: Implement New Naolib user registration

    // Step 3: Verify success
    await expect(page.locator('[data-testid="success-message"]')).toBeVisible();
  });

});

```

## Required Selectors
- Navigation: `[data-testid="nav-*"]`
- Forms: `[data-testid="form-*"]`
- Buttons: `[data-testid="btn-*"]`
- Status: `[data-testid="status-*"]`

## Success Criteria
- [ ] Test file created with proper structure
- [ ] All user steps implemented
- [ ] Selectors use data-testid
- [ ] Test runs without skip
- [ ] AO compliance verified

## Ralph Status Block
---RALPH_STATUS---
STATUS: COMPLETED
COMPLEXITY: medium
WSJF: 8
---END_RALPH_STATUS---

## Last Failure (Tue Jan 13 18:58:53 CET 2026)
```
<think>
Let me get a better view of the file structure to understand the patterns used.
</think>

```bash
sed -n '1,80p' tests/e2e/01-authentication.spec.ts
```

=== Action Results ===
bash: OK
// ============================================================================
// E2E Tests: Authentication - ALL Cases (Happy + Error)
// ============================================================================
// Status: ðŸ”´ RED (TDD - Tests written first, implementation follows)
// Coverage: 100% authentication scenarios
// ============================================================================

import { test, expect } from '@playwright/test';

// =====================================
```

## Last Failure (Tue Jan 13 19:00:59 CET 2026)
```
  test('Registration shows validation errors for missing fields', async ({ page }) => {
    await page.click('[

=== LLM Response ===
Let me verify if the journeys directory exists and create the file:

```bash
ls -la tests/e2e/journeys/ 2>/dev/null || echo "Directory does not exist"
```

=== Action Results ===
bash: OK
total 2144
drwxr-xr-x  143 sylvain  staff   4576 Dec 24 11:50 .
drwxr-xr-x   52 sylvain  staff   1664 Jan 13 18:50 ..
-rw-r--r--    1 sylvain  staff  23141 Dec 24 11:50 01-auth-journeys-ao-enhanced-v2.spec.ts
-rw-r--r--    1 sylvain  staff  13660 Dec 24 11:50 01-auth-journeys-ao-enhanced.spec.ts
-rw-r--r--    1 sylvain  staff   4265 Dec 24 11:50 01-auth-journeys.spec.ts
-rw-r--r--    1 sylvain  staff   6452 Dec 24 11:50 01-subscription-creation-complete.spec.ts
-rw-r--r--    1 sylvain  staff   3
```

## Last Failure (Tue Jan 13 19:01:28 CET 2026)
```
cat tests/e2e/journeys/01-subscription-creation-complete.spec.ts | head -165
```

=== Action Results ===
bash: OK
import { test, expect } from '@playwright/test';
import { MailpitHelper } from '../helpers/mailpit';

/**
 * Journey E2E #1: CrÃ©ation Abonnement ComplÃ¨te
 * AO IDFM Â§2.1.1: Parcours inscription utilisateur avec paiement
 * AO Nantes Â§1.2: Workflow souscription intÃ©gral
 */
test.describe('Journey: CrÃ©ation Abonnement ComplÃ¨te', () => {
  let mailpit: MailpitHelper;
  const networkErrors: string[] = [];
  const consoleErrors: string[] = [];

  test.beforeEach(async ({ page }) => {
    mailpit = ne
```

## Last Failure (Wed Jan 14 08:32:59 CET 2026)
```
[0;32m[AGENT] Real Agent starting[0m
[0;34m[AGENT] Task: /Users/sylvain/_LAPOSTE/_VELIGO2/tools/ralph-wiggum/tasks/T141.md[0m
[0;34m[AGENT] Queue: tdd[0m
[0;34m[AGENT] Backend: local[0m
[0;32m[AGENT] Starting task: T141[0m
[0;34m[AGENT] Iteration 1/10[0m
[0;31m[AGENT] Local LLM failed: HTTPConnectionPool(host='127.0.0.1', port=8002): Read timed out. (read timeout=300)[0m

============================================================
RESULT: FAILED
============================================================
ERROR: LLM call failed
```

## Last Failure (Wed Jan 14 08:33:32 CET 2026)
```
[0;32m[AGENT] Real Agent starting[0m
[0;34m[AGENT] Task: /Users/sylvain/_LAPOSTE/_VELIGO2/tools/ralph-wiggum/tasks/T141.md[0m
[0;34m[AGENT] Queue: tdd[0m
[0;34m[AGENT] Backend: local[0m
[0;32m[AGENT] Starting task: T141[0m
[0;34m[AGENT] Iteration 1/10[0m
[0;31m[AGENT] Local LLM failed: ('Connection aborted.', ConnectionResetError(54, 'Connection reset by peer'))[0m

============================================================
RESULT: FAILED
============================================================
ERROR: LLM call failed
```

## Last Failure (Wed Jan 14 08:33:39 CET 2026)
```
[0;32m[AGENT] Real Agent starting[0m
[0;34m[AGENT] Task: /Users/sylvain/_LAPOSTE/_VELIGO2/tools/ralph-wiggum/tasks/T141.md[0m
[0;34m[AGENT] Queue: tdd[0m
[0;34m[AGENT] Backend: local[0m
[0;32m[AGENT] Starting task: T141[0m
[0;34m[AGENT] Iteration 1/10[0m
[0;31m[AGENT] Local LLM failed: HTTPConnectionPool(host='127.0.0.1', port=8002): Max retries exceeded with url: /v1/chat/completions (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1071b0590>: Failed to establish a new connection: [Errno 61] Connection refused'))[0m

============================================================
RESULT: FAILED
============================================================
ERROR: LLM call failed
```
