# Task T443: Upgrade/downgrade plan en cours d'abonnement

**Priority**: P1
**WSJF Score**: 7.5
**Queue**: TDD
**Category**: JOURNEY
**Original ID**: J-E2E-008
**Phase**: üö¥ PHASE 1: JOURNEYS E2E ESSENTIELS (Priority P0)
**Section**: 1.2 Souscription & Paiement

## Description
Upgrade/downgrade plan en cours d'abonnement

## Test File
`journeys/108-plan-change.spec.ts`

## Estimated Files
3 fichier(s) √† modifier

## Success Criteria
- [ ] Test E2E cr√©√©/modifi√©: `journeys/108-plan-change.spec.ts`
- [ ] Test passe en local
- [ ] Pas de test.skip() sans condition
- [ ] Code review adversarial pass√©
- [ ] Pas de stubs ou TODOs

## Definition of Done (DoD)
- [ ] Feature compl√®tement impl√©ment√©e
- [ ] Tests E2E verts
- [ ] Conformit√© AO v√©rifi√©e (si applicable)
- [ ] Documentation mise √† jour

## Ralph Status Block
---RALPH_STATUS---
STATUS: FAILED
COMPLEXITY: medium
WSJF: 7.5
CATEGORY: JOURNEY
ORIGINAL_ID: J-E2E-008
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 13:47:10 CET 2026)
```
cat veligo-platform/frontend/tests/journeys/subscription.journey.spec.ts</bash>

=== Action Results ===
bash: OK
/**
 * E2E Journey Tests - Subscription Complete
 * TDD Red Phase - Real selectors, real fixtures, real API calls
 *
 * Personas tested:
 * - USER_IDFM: Eligible for IDFM subsidy (50% up to 500EUR)
 * - USER_NANTES: Eligible for Nantes Metropole subsidy (40% up to 300EUR)
 * - USER_LYON: No specific subsidy
 *
 * Journeys covered:
 * 1. Browse catalog
 * 2. Select plan
 * 3. Apply subsidy (IDFM, Nantes)
 * 4. Payment flow (Stripe/Paynum)
 * 5. Subscription confirmation
 * 6. Subscription managem
```

## Last Failure (Wed Jan 14 13:49:38 CET 2026)
```
<bash>
cat /Users/sylvain/_LAPOSTE/_VELIGO2/tests/e2e/journeys/01-subscription-creation-complete.spec.ts</bash>

=== Action Results ===
bash: OK
import { test, expect } from '@playwright/test';
import { MailpitHelper } from '../helpers/mailpit';

/**
 * Journey E2E #1: Cr√©ation Abonnement Compl√®te
 * AO IDFM ¬ß2.1.1: Parcours inscription utilisateur avec paiement
 * AO Nantes ¬ß1.2: Workflow souscription int√©gral
 */
test.describe('Journey: Cr√©ation Abonnement Compl√®te', () => {
  let mailpit: MailpitHelper;
  const networkErrors: string[] = [];
  const consoleErrors: string[] = [];

  test.beforeEach(async ({ page }) => {
    mailpit = ne
```

## Last Failure (Wed Jan 14 13:51:41 CET 2026)
```
  password: 'PaymentTest123!'
};

// Test card (Stripe test)
const TEST_CARD = {
  number: '4242424242424242',
  expiry: '12/28',
  cvc: '1

=== LLM Response ===
<think>
Let me try to get the full content of the payment-flow spec file to understand the patterns used.
</think>

<bash>
wc -l ./veligo-platform/frontend/tests/journeys/08-payment-flow.spec.ts</bash>

=== Action Results ===
bash: OK
     418 ./veligo-platform/frontend/tests/journeys/08-payment-flow.spec.ts
```
