# Task T206: Implement ScheduleMaintenance gRPC method

**Priority**: P1
**Queue**: TDD
**Type**: implementation

## File
veligo-platform/backend/src/grpc/services/bike.rs

## Description
Implement ScheduleMaintenance to create maintenance record for a bike

## Success Criteria
- [ ] Implementation complete
- [ ] cargo check passes
- [ ] Unit tests added
- [ ] No new warnings

## Ralph Status Block
---RALPH_STATUS---
STATUS: COMPLETED
COMPLEXITY: medium
WSJF: 8
---END_RALPH_STATUS---

## Last Failure (Tue Jan 13 23:55:05 CET 2026)
```
    Bike as Pro

=== LLM Response ===
<think>
The output is getting cut off. Let me try to view the file in sections or use a different approach.
</think>

```bash
tail -100 veligo-platform/backend/src/grpc/services/bike.rs
```

=== Action Results ===
bash: OK
                let status_enum = match status_str.as_deref() {
                    Some("available") => ProtoBikeStatus::Available as i32,
                    Some("reserved") => ProtoBikeStatus::Reserved as i32,
                    Some("in_use") => ProtoBikeStatus::InUse as i32,
                    Some("maintenance") => ProtoBikeStatus::Maintenance as i32,
                    Some("out_of_service") => ProtoBikeStatus::OutOfService as i32,
                    Some("stolen") => ProtoBikeStatus
```

## Last Failure (Tue Jan 13 23:55:47 CET 2026)
```
        }))
    }

    async fn get(&self, request: Request<GetRequest>) -> Result<Response<ProtoBike>, Status> {
        // Get metadata before consuming request
        let metadata = request.metadata().clone();
        let req = request.into_inner

=== LLM Response ===
<think>
Let me see more of the file to understand the patterns better, especially the get method and the end of the file to see if there's a ScheduleMaintenance stub.
</think>

<bash>
grep -n "ScheduleMaintenance" veligo-platform/backend/src/grpc/services/bike.rs</bash>

=== Action Results ===
bash: OK
1165:        _request: Request<crate::proto::bike::v1::ScheduleMaintenanceRequest>,
1168:            "ScheduleMaintenance is not yet implemented",
```

## Last Failure (Tue Jan 13 23:57:27 CET 2026)
```
<bash>
grep -r "maintenance_records" veligo-platform/backend/migrations/ 2>/dev/null | head -20</bash>

=== Action Results ===
bash: OK
veligo-platform/backend/migrations/031_fix_rls_null_bypass.sql:-- 4. FIX: maintenance_records table RLS policy
veligo-platform/backend/migrations/031_fix_rls_null_bypass.sql:DROP POLICY IF EXISTS tenant_isolation_maintenance ON maintenance_records;
veligo-platform/backend/migrations/031_fix_rls_null_bypass.sql:CREATE POLICY tenant_isolation_maintenance ON maintenance_records
veligo-platform/backend/migrations/015_fixes_and_missing_tables.sql:--   - maintenance_records table (for fleet management

=== LLM Response ===
<think>
There's a maintenance_records table. Let me check the schema for it.
</think>

<bash>
grep -B 5 -A 50 "CREATE TABLE maintenance_records" veligo-platform/backend/migrations/015_fixes_and_missing_tables.sql</bash>

=== Action Results ===
bash: FAIL
```
