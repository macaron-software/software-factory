# Task T494: Module open-data-api

**Priority**: P2
**WSJF Score**: 6.5
**Queue**: TDD
**Category**: MODULE
**Original ID**: MOD-RGPD-006
**Phase**: üì¶ PHASE 4: MODULES BACKEND (Priority P2)
**Section**: 4.6 RGPD & Compliance Modules

## Description
Module open-data-api

## Test File
`modules/open-data-api.spec.ts`

## Estimated Files
4 fichier(s) √† modifier

## Success Criteria
- [ ] Test E2E cr√©√©/modifi√©: `modules/open-data-api.spec.ts`
- [ ] Test passe en local
- [ ] Pas de test.skip() sans condition
- [ ] Code review adversarial pass√©
- [ ] Pas de stubs ou TODOs

## Definition of Done (DoD)
- [ ] Feature compl√®tement impl√©ment√©e
- [ ] Tests E2E verts
- [ ] Conformit√© AO v√©rifi√©e (si applicable)
- [ ] Documentation mise √† jour

## Ralph Status Block
---RALPH_STATUS---
STATUS: FAILED
COMPLEXITY: medium
WSJF: 6.5
CATEGORY: MODULE
ORIGINAL_ID: MOD-RGPD-006
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 14:24:49 CET 2026)
```
  rpc ToggleModule(ToggleModuleRequest) returns (ToggleModuleResponse);
}

message Module {
  string id = 1;
  string slug = 2;
  string name = 
---
bash: FAIL

---
bash: OK
veligo-platform/owner/backend/src/infrastructure/http/admin_routes.rs
veligo-platform/owner/backend/src/infrastructure/http/admin_rgpd_routes.rs
veligo-platform/owner/backend/src/infrastructure/http/handlers/admin/rgpd.rs
veligo-platform/owner/backend/src/infrastructure/http/handlers/admin/mod.rs
veligo-platform/owner/backend/src/handlers/admin/rgpd.rs
veligo-platform/owner/backend/src/handlers/admin/mod.rs
veligo-platform/owner/backend/src/handlers/admin_owner.rs
veligo-platform/backend/target/
```

## Last Failure (Wed Jan 14 14:25:23 CET 2026)
```
```bash
cat veligo-platform/frontend/tests/e2e/modules.spec.ts | head -300 | tail -100
```

=== Action Results ===
bash: OK
    const categorySelector = page.locator(S.owner.categorySelector);
    await categorySelector.selectOption('security');

    // Wait for filter to apply
    await page.waitForTimeout(500);

    // Security modules should be visible
    const mfaCard = page.locator(S.owner.moduleCard('mfa'));
    await expect(mfaCard).toBeVisible();

    // Core modules should not be visible
    const coreCard = page.locator(S.owner.moduleCard('core_booking'));
    await expect(coreCard).not.toBeVisible();
  })
```

## Last Failure (Wed Jan 14 14:26:03 CET 2026)
```
=== LLM Response ===
<think>
The open-data-api module is not yet in the test file. Let me look for existing module definitions and understand the module architecture better.
</think>

```bash
grep -n "mfa\|challenges\|core_booking" veligo-platform/frontend/tests/e2e/modules.spec.ts | head -30
```

=== Action Results ===
bash: OK
48:    mfaEnabled: '[data-testid="mfa-settings"]',
73:  security: ['mfa', 'sso-franceconnect', 'audit-logs'],
77:  gamification: ['challenges', 'leaderboards', 'rewards'],
208:    const mfaCard = page.locator(S.owner.moduleCard('mfa'));
209:    await expect(mfaCard).toBeVisible();
212:    const coreCard = page.locator(S.owner.moduleCard('core_booking'));
223:    const mfaCard = page.locator(S.owner.moduleCard('mfa'));
224:    await expect(mfaCard).toBeVisible();
227:    const bookingCard = page.
```

## Last Failure (Wed Jan 14 14:27:07 CET 2026)
```
use serde::{Deserialize, Serialize};
use serde_json::Value as JsonValue;
use uuid::Uuid;
use chrono::{DateTime, Utc};
use std::collections::HashMap;
use tracing::{info, warn, error};

// ============================================================================
// T
---
bash: OK
total 2208
drwxr-xr-x  50 sylvain  staff   1600 Jan 14 14:15 .
drwxr-xr-x  22 sylvain  staff    704 Jan 14 13:57 ..
-rw-r--r--   1 sylvain  staff  20744 Dec 31 21:24 accessibility_module.rs
drwxr-xr-x   3 sylvain  staff     96 Jan  6 22:10 auth
drwxr-xr-x   3 sylvain  staff     96 Jan  7 02:22 bike
-rw-r--r--   1 sylvain  staff  36568 Dec 31 22:12 bike_maintenance_module.rs
-rw-r--r--   1 sylvain  staff  20289 Dec 31 22:12 bike_tracking_module.rs
drwxr-xr-x   6 sylvain  staff    192 Jan 14 14:17
```

## Last Failure (Wed Jan 14 14:28:01 CET 2026)
```
use crate::domain::module::VeligoModule;
use axum::{
    extract::{Path, State},
    routing::{get, post},
    Json, Router,
};
use serde::{Deserialize, Serialize};
use sqlx::{FromRow, PgPool};
use uuid::Uuid;

#[derive(Debug, Clone, Serialize, Deserialize, FromRow)]
pub struct AccessibilitySettings {
    pub id: Uuid,
    pub tenant_id: Uuid,
    pub created_at: Option<chrono::DateTime<chrono::Utc>>,
    pub updated_at: Option<chrono::DateTime<chrono::Utc>>,
}

#[derive(Debug, Deserialize)]
pub
```

## Last Failure (Wed Jan 14 14:32:47 CET 2026)
```
            VeligoModule::Locations => \"locations\",
            VeligoModule::Pricing => \"pricing\",
        }
    }
}" new="            VeligoModule::Notifications => \"notifications\",
            VeligoModule::Locations => \"locations\",
            VeligoModule::Pricing => \"pricing\",
            VeligoModule::OpenDataApi => \"open-data-api\",
        }
    }
}"/>
```

**Change 2: Add open_data_api module to handlers/admin/mod.rs**

<edit file="veligo-platform/backend/src/handlers/admin/mod.rs" old="pub mod rgpd;
pub mod owner;
pub mod module_settings;" new="pub mod rgpd;
pub mod owner;
pu
```

## Gates Failure (Wed Jan 14 14:35:18 CET 2026)
```
=== Gate Report: T494 ===
  ‚úó Fail-on-Stubs: 71 stubs/TODOs found
      - veligo-platform/services/veligo-auth-service/src/handlers.rs:78: // TODO: Implement actual login with database lookup
      - veligo-platform/backend/src/bin/tonic-server.rs:1715: // TODO: Implement rate limiting via tonic interceptors instead of tower layers
      - veligo-platform/backend/src/infrastructure/http/module_routes.rs:265: // TODO: Add tests
  ‚úì Security: No security issues detected
  FAILED
```

## Last Failure (Wed Jan 14 14:36:26 CET 2026)
```
    routing::{get, post},
    Json, Router,
};
use serde::{Deserialize, Serialize};
use sqlx::PgPool;
use std::sync::Arc;
use uuid::Uuid;

// Import from backend
use crate::domain::module::{ModuleCategory, ModuleResult, VeligoModule};

pub struct BillingModule;

#[async_trait::async_trait]
impl VeligoModule for BillingModule {
    fn slug(&self) -> &str {
    
---
bash: FAIL
cat: veligo-platform/frontend/tests/e2e/modules/fixtures.ts: No such file or directory
```

## Last Failure (Wed Jan 14 14:37:01 CET 2026)
```
// TDD: RED phase - Define interface first

use axum::Router;
use sqlx::PgPool;
use std::error::Error;
use std::fmt;

/// Module-specific error type
#[derive(Debug)]
pub enum ModuleError {
    InitializationFailed(String),
    CleanupFailed(String),
    MigrationFailed(String),
    NotFound(String),
}

impl fmt::Display for ModuleError {
    fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {
        match self {
            Self::I
```

## Last Failure (Wed Jan 14 14:37:08 CET 2026)
```
// TDD: RED phase - Define interface first

use axum::Router;
use sqlx::PgPool;
use std::error::Error;
use std::fmt;

/// Module-specific error type
#[derive(Debug)]
pub enum ModuleError {
    InitializationFailed(String),
    CleanupFailed(String),
    MigrationFailed(String),
    NotFound(String),
}

impl fmt::Display for ModuleError {
    fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {
        match self {
            Self::I
```

## Last Failure (Wed Jan 14 14:37:40 CET 2026)
```

<invoke><bash>
<command>ls veligo-platform/backend/src</command>
 <timeout></timeout>
 <env></env>
</bash></invoke>


=== Action Results ===
bash: FAIL
/bin/sh: -c: line 0: syntax error near unexpected token `<'
/bin/sh: -c: line 0: `
<command>ls veligo-platform/backend/src</command>
 <timeout></timeout>
 <env></env>
'


=== LLM Response ===
<think>
I'm having issues with the command format. Let me try a simpler command structure.
</think>

<invoke><bash>
<command>ls veligo-platform/backend/src</command>
 <timeout></timeout>
 <env></env>
</bash></invoke>


=== Action Results ===
bash: FAIL
/bin/sh: -c: line 0: syntax error near unexpected token `<'
/bin/sh: -c: line 0: `
<command>ls veligo-platform/backend/src</command>
 <timeout></timeout>
 <env></env>
'
```

## Last Failure (Wed Jan 14 14:38:21 CET 2026)
```
// TDD: RED phase - Define interface first

use axum::Router;
use sqlx::PgPool;
use std::error::Error;
use std::fmt;

/// Module-specific error type
#[derive(Debug)]
pub enum ModuleError {
    InitializationFailed(String),
    CleanupFailed(String),
    MigrationFailed(String),
    NotFound(String),
}

impl fmt::Display for ModuleError {
    fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {
        match self {
            Self::I
```

## Last Failure (Wed Jan 14 14:38:32 CET 2026)
```
// TDD: RED phase - Define interface first

use axum::Router;
use sqlx::PgPool;
use std::error::Error;
use std::fmt;

/// Module-specific error type
#[derive(Debug)]
pub enum ModuleError {
    InitializationFailed(String),
    CleanupFailed(String),
    MigrationFailed(String),
    NotFound(String),
}

impl fmt::Display for ModuleError {
    fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {
        match self {
            Self::I
```

## Last Failure (Wed Jan 14 14:39:09 CET 2026)
```
I see that `mod.rs` doesn't include `open_data_api` yet. Let me check the open_data_api.rs file to see what's already there.
</think>

```bash
cat veligo-platform/backend/src/handlers/admin/open_data_api.rs
```

=== Action Results ===
bash: OK
use axum::{routing::get, Router};
use sqlx::PgPool;

/// OpenDataApi module handler
/// This module provides APIs for open data compliance (RGPD/OpenData regulations)

/// Returns the router for the OpenDataApi module
pub fn router(pool: sqlx::PgPool) -> Router {
    Router::new()
        .route(\"/open-data-api/status\", get(|| async { \"OpenDataApi module active\" }))
}
```

## Last Failure (Wed Jan 14 14:39:10 CET 2026)
```
<invoke><bash>
<command>echo "test"</command>
 <timeout></timeout>
 <env></env>
</bash></invoke>

=== Action Results ===
bash: FAIL
/bin/sh: -c: line 0: syntax error near unexpected token `newline'
/bin/sh: -c: line 0: `<command>echo "test"</command>'


=== LLM Response ===
<think>
Something is wrong with the bash command format. Let me try without the XML tags.
</think>

```
echo "test"
```
```
