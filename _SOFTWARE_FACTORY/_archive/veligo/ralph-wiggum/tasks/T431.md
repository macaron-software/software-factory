# Task T431: Correspondance m√©tro/tram

**Priority**: P1
**WSJF Score**: 7.8
**Queue**: TDD
**Category**: AO_COMPLIANCE
**Original ID**: AO-LYON-003
**Phase**: üéØ PHASE 2: COMPLIANCE AO (Priority P1)
**Section**: 2.3 Lyon - TCL

## Description
Correspondance m√©tro/tram

## Test File
`ao/lyon-correspondence.spec.ts`

## Estimated Files
4 fichier(s) √† modifier

## Success Criteria
- [ ] Test E2E cr√©√©/modifi√©: `ao/lyon-correspondence.spec.ts`
- [ ] Test passe en local
- [ ] Pas de test.skip() sans condition
- [ ] Code review adversarial pass√©
- [ ] Pas de stubs ou TODOs

## Definition of Done (DoD)
- [ ] Feature compl√®tement impl√©ment√©e
- [ ] Tests E2E verts
- [ ] Conformit√© AO v√©rifi√©e (si applicable)
- [ ] Documentation mise √† jour

## Ralph Status Block
---RALPH_STATUS---
STATUS: FAILED
COMPLEXITY: medium
WSJF: 7.8
CATEGORY: AO_COMPLIANCE
ORIGINAL_ID: AO-LYON-003
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 13:40:58 CET 2026)
```
<bash>
cat veligo-platform/tests/e2e/ao-compliance/lyon-tcl.spec.ts</bash>

=== Action Results ===
bash: OK
import { test, expect } from '@playwright/test';
import { v4 as uuidv4 } from 'uuid';

const TENANTS = {
  idfm: 'http://idfm.veligo.test:8888',
  nantes: 'http://nantes.veligo.test:8888',
};

// Helper to test endpoints with cross-tenant access
async function testCrossTenantAccess(page: any, endpoint: string, tenant: string) {
  const otherTenant = tenant === 'idfm' ? 'nantes' : 'idfm';
  const otherUrl = TENANTS[otherTenant];
  
  // Try to access endpoint with wrong tenant
  const response = 
```

## Last Failure (Wed Jan 14 13:42:10 CET 2026)
```
<bash>
cat veligo-platform/tests/e2e/ao-compliance/lyon-tcl.spec.ts | head -150</bash>

=== Action Results ===
bash: OK
import { test, expect } from '@playwright/test';
import { v4 as uuidv4 } from 'uuid';

const TENANTS = {
  idfm: 'http://idfm.veligo.test:8888',
  nantes: 'http://nantes.veligo.test:8888',
};

// Helper to test endpoints with cross-tenant access
async function testCrossTenantAccess(page: any, endpoint: string, tenant: string) {
  const otherTenant = tenant === 'idfm' ? 'nantes' : 'idfm';
  const otherUrl = TENANTS[otherTenant];
  
  // Try to access endpoint with wrong tenant
  const response = 
```

## Last Failure (Wed Jan 14 13:44:15 CET 2026)
```
strings tests/e2e/ao-compliance/lyon/tcl-multimodal.spec.ts | head -300</bash>
<bash>
grep -n "correspondance\|correspondence\|metro\|tram" tests/e2e/ao-compliance/lyon/tcl-multimodal.spec.ts 2>/dev/null | head -20</bash>

=== Action Results ===
bash: OK
// ============================================================================
 AO-LYON-
4.2.1 - TCL MULTIMODAL (SIMPLIFIED)
// ============================================================================
// **AO Ref:** Lyon TCL AO p.32 
4.2.1
// **Tests:** 4 critical tests - Simplified without helper dependencies
// ============================================================================
import { test, expect } from '@playwright/test';
const LYON_BASE_URL = process.env.LYON_URL || 'https:/
---
bash: OK
15:  // TEST 1: Journey planner bike + metro
35:        const bikeMetro = page.locator('[data-testid="mode-bike-metro"]');
```
