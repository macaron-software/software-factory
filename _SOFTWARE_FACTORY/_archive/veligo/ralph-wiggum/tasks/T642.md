# Task T642: Implement StripeAdapter with common interface

**Priority**: P1
**WSJF Score**: 8.0
**Queue**: TDD
**Parent**: T623
**Generated by**: Fractal LLM Delegation

## Description
Implement StripeAdapter with common interface

## Reason for Delegation
Task requires implementation of two payment adapters (Paynum + Stripe), factory pattern, and integration tests across multiple files, touching backend infrastructure and testing layers. This spans more than 5 files and involves HTTP clients, API integrations, and test mocking.

## Success Criteria
- [ ] Task completed
- [ ] Tests pass
- [ ] No stubs or TODOs

## Ralph Status Block
---RALPH_STATUS---
STATUS: FAILED
COMPLEXITY: medium
PARENT_TASK: T623
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 17:52:39 CET 2026)
```
    pub payment_id: String,
    pub amount: u64,
    pub
---
bash: OK
//! # Stripe Payment Adapter
//!
//! Production-ready Stripe payment processing for Veligo Platform.
//!
//! ## Features
//!
//! - **Checkout Sessions**: Create payment URLs for subscriptions
//! - **Webhook Handling**: Secure signature verification with replay protection
//! - **Refunds**: Full and partial refund support
//! - **Retry Logic**: Exponential backoff for transient failures
//! - **Structured Logging**: Full tracing integration
//!
//! ## Required Environment Variables
//!
//! | Var
```

## Last Failure (Wed Jan 14 17:53:12 CET 2026)
```


=== LLM Response ===
<think>
There seems to be a persistent issue with bash commands. Let me look at the error more carefully - it seems like the shell is having trouble parsing the command. Let me try using cat to read files or other approaches.

Actually, let me look at the error again - it says "syntax error near unexpected token `newline'". This is strange because the commands I'm sending look correct.

Let me try to understand the workspace by looking at files directly.
</think>

<invoke><bash>
<command>ls</command>
 <timeout></timeout>
</bash></invoke>

=== Action Results ===
bash: FAIL
/bin/sh: -c: line 0: syntax error near unexpected token `newline'
/bin/sh: -c: line 0: `<command>ls</command>'
```

## Last Failure (Wed Jan 14 17:54:04 CET 2026)
```
drwxr-xr-x   5 sylvain  staff   160 Dec 16 09:38 grpc
drwxr-xr-x  21 sylvain  staff   672 Dec 16 09:38 ht

=== LLM Response ===
<think>
Let me explore the adapters directory to understand the existing adapter pattern.
</think>

```bash
ls -la veligo-platform/tenant/backend-api/src/infrastructure/adapters/
```

=== Action Results ===
bash: OK
total 8
drwxr-xr-x   5 sylvain  staff  160 Dec 16 09:38 .
drwxr-xr-x  15 sylvain  staff  480 Jan 12 17:48 ..
-rw-r--r--   1 sylvain  staff   90 Dec 16 09:38 mod.rs
drwxr-xr-x   5 sylvain  staff  160 Dec 16 09:38 payment
drwxr-xr-x   5 sylvain  staff  160 Dec 16 09:38 theme
```
