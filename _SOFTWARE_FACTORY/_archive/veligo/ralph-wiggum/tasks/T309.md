# Task T309: Add admin dashboard data loading

**Priority**: P1
**Queue**: TDD
**Type**: implementation

## File
veligo-platform/frontend/src/routes/(admin)/admin-dashboard/+page.server.ts

## Description
Add load function to fetch dashboard stats via gRPC GetDashboardStats

## Success Criteria
- [ ] Implementation complete
- [ ] cargo check passes (or npm run build for frontend)
- [ ] Unit/integration tests added
- [ ] No new warnings
- [ ] Works with gRPC calls (frontend) or database queries (backend)

## Ralph Status Block
---RALPH_STATUS---
STATUS: FAILED
COMPLEXITY: medium
WSJF: 10
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 10:01:14 CET 2026)
```
 * Bike gRPC-Web client using @connectrpc/connect-web
 * 
 * PR-006: Frontend gRPC-Web Client Setup
 * Wrapper for bike/fleet service using Connect transport
 */

import { handleGrpcError } from './client';
import type {
  GetBikeRequest,
  ListBikesRequest,
  ListBikesResponse,
  CreateBikeRequest,
  UpdateBikeRequest,
  DeleteBikeRequest,
  DeleteBikeResponse,
  GetBikesByStationRequest,
  UpdateBikeStatusRequest,
  ReserveBikeRequest,
  CancelReservationRequest,
  CancelReservationRespons
```

## Last Failure (Wed Jan 14 10:01:42 CET 2026)
```
    "te

=== LLM Response ===
<think>
Let me continue exploring the project structure to find the gRPC client setup.
</think>

```bash
find veligo-platform/frontend -name "*.ts" | xargs grep -l "grpc\|Grpc\|GetDashboardStats" 2>/dev/null | head -20
```

=== Action Results ===
bash: OK
veligo-platform/frontend/node_modules/ts-proto/build/src/options.d.ts
veligo-platform/frontend/node_modules/ts-proto/build/src/main.d.ts
veligo-platform/frontend/node_modules/ts-proto/build/src/generate-grpc-js.d.ts
veligo-platform/frontend/node_modules/ts-proto/build/src/generate-nice-grpc.d.ts
veligo-platform/frontend/node_modules/ts-proto/build/src/generate-grpc-web.d.ts
veligo-platform/frontend/node_modules/ts-proto/build/src/generate-nestjs.d.ts
veligo-platform/frontend/node_modules/ts-prot
```

## Last Failure (Wed Jan 14 10:02:13 CET 2026)
```
export interface GetDashboardStatsResponse {
    /**
     * @generated from protobuf field: veligo.report.v1.DashboardStats stats = 1
     */
    stats?: DashboardStats;
}
/**
 * @generat

=== LLM Response ===
```bash
grep -r "reportClient\|ReportService" veligo-platform/frontend/src/lib/ --include="*.ts" | head -10
```

=== Action Results ===
bash: OK
veligo-platform/frontend/src/lib/grpc/report/v1/report.ts: * @generated ServiceType for protobuf service veligo.report.v1.ReportService
veligo-platform/frontend/src/lib/grpc/report/v1/report.ts:export const ReportService = new ServiceType("veligo.report.v1.ReportService", [
veligo-platform/frontend/src/lib/grpc/report/v1/report.client.ts:import { ReportService } from "./report";
veligo-platform/frontend/src/lib/grpc/report/v1/report.client.ts: * @generated from protobuf service veligo.report.v1.
```

## Last Failure (Wed Jan 14 10:02:46 CET 2026)
```
     *
     * @generated from protobuf rpc: GenerateReport
     */
--
    getDashboardStats(input: GetDashboardStatsRequest, options?: RpcOptions): UnaryCall<GetDashboardStatsRequest, GetDashboardStatsResponse> {
        const method = this.methods[0], opt = this._transport.mergeOptions(options);
        return stackInterce

=== LLM Response ===
<think>
Now I need to understand how the gRPC client is instantiated. Let me check the existing admin page and other similar server files to see the pattern used.
</think>

```bash
head -100 "veligo-platform/frontend/src/routes/(admin)/admin-dashboard/+page.svelte"
```

=== Action Results ===
bash: OK
<!-- Placeholder - will be implemented -->
```

## Last Failure (Wed Jan 14 10:03:22 CET 2026)
```
wc -l "veligo-platform/frontend/src/lib/grpc/client.ts" && tail -50 "veligo-platform/frontend/src/lib/grpc/client.ts"
```

=== Action Results ===
bash: OK
     258 veligo-platform/frontend/src/lib/grpc/client.ts
      }
    }
    
    // Check for AbortError or other fetch-related errors
    if (err.name === 'AbortError') {
      return 'Requête annulée. Veuillez réessayer.';
    }
    
    // Check if error has a cause that might contain status info
    if (err.cause && typeof err.cause === 'object') {
      const cause = err.cause as any;
      if (cause.status !== undefined) {
        if (cause.status === 401) {
          return 'Non autorisé. 
```

## Last Failure (Wed Jan 14 10:03:55 CET 2026)
```
Let me try a different approach - output the file to a temp file and view it with line numbers.
</think>

<bash>
nl -ba "veligo-platform/frontend/src/lib/grpc/client.ts" | head -80</bash>

=== Action Results ===
bash: OK
     1	/**
     2	 * Base gRPC-Web client setup using @connectrpc/connect-web
     3	 * 
     4	 * PR-006: Frontend gRPC-Web Client Setup
     5	 * This module provides the base transport and client configuration for gRPC-Web calls.
     6	 */
     7	
     8	import { createConnectTransport } from '@connectrpc/connect-web';
     9	import type { Transport } from '@connectrpc/connect';
    10	
    11	// gRPC-Web endpoint - routes to tonic-server via nginx proxy
    12	const GRPC_BASE_URL = import.m
```
