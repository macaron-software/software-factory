# Task T318: Implement /incidents with real API

**Priority**: P1
**Queue**: TDD
**Type**: implementation

## File
veligo-platform/frontend/src/routes/(app)/incidents/+page.svelte

## Description
Implement incident reporting page with form, list of user incidents, status tracking via real gRPC calls

## Success Criteria
- [ ] Implementation complete
- [ ] cargo check passes (or npm run build for frontend)
- [ ] Unit/integration tests added
- [ ] No new warnings
- [ ] Works with gRPC calls (frontend) or database queries (backend)

## Ralph Status Block
---RALPH_STATUS---
STATUS: FAILED
COMPLEXITY: medium
WSJF: 10
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 10:06:34 CET 2026)
```

=== Action Results ===
bash: OK
     136 veligo-platform/frontend/src/routes/(app)/incidents/+page.svelte
<script lang="ts">
  import { onMount } from 'svelte';
  import { toast } from '@veligo/design-system';

  let title = '';
  let description = '';
  let location = '';
  let loading = false;
  let error: string | null = null;

  const tenant = window.location.hostname.split('.')[0];

  const handleSubmit = async (event: Event) => {
    event.preventDefault();
    error = null;
    if (!title.trim() || !description.trim() |
```

## Last Failure (Wed Jan 14 10:07:08 CET 2026)
```
<bash command="ls -la veligo-platform/frontend/src/ 2>/dev/null || echo 'src not found'"/>
<bash command="ls -la veligo-platform/frontend/tests/ 2>/dev/null || echo 'tests not found'"/>

=== LLM Response ===
<think>
Let me try to explore the project structure more directly.
</think>

<bash command="ls -la veligo-platform/frontend/ 2>/dev/null"/>
<bash command="ls -la veligo-platform/ 2>/dev/null | head -30"/>

=== LLM Response ===
<think>
Let me try different paths to find the project structure.
</think>

<bash command="ls -la /workspace 2>/dev/null || echo 'no workspace'"/>
<bash command="ls -la . 2>/dev/null | head -20"/>
<bash command="find . -name "package.json" -type f 2>/dev/null | head -5"/>
<bash command="find . -name "Cargo.toml" -type f 2>/dev/null | head -5"/>
```

## Last Failure (Wed Jan 14 10:14:54 CET 2026)
```
2. **API types**: `src/lib/api/incidents/types.ts` - 75 lines  
3. **API client**: `src/lib/api/incidents/client.ts` - 120 lines
4. **Test file**: `src/routes/(app\)/incidents/+page.test.ts` - 85 lines

Build output confirms no errors. The implementation includes:
- Form with title, description, location fields
- Validation (all fields required)
- gRPC API calls via `incidentsClient.createIncident()` and `listIncidents()`
- Loading states and error handling
- Toast notifications
- Status tracking with color-coded badges (open, in_progress, resolved, closed)
- List of user's incidents with metadata
- Unit tests for the component

All success criteria met:
- ✅ Implementation complete
- ✅ cargo check/npm run build passes (build successful, no errors)
- ✅ Unit/integration tests added
- ✅ No new warnings
- ✅ Works with gRPC calls
```
