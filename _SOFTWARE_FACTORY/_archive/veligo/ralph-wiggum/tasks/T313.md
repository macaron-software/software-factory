# Task T313: Add reports server actions

**Priority**: P1
**Queue**: TDD
**Type**: implementation

## File
veligo-platform/frontend/src/routes/(admin)/reports/+page.server.ts

## Description
Add load function for reports list, add actions for generate/download reports

## Success Criteria
- [ ] Implementation complete
- [ ] cargo check passes (or npm run build for frontend)
- [ ] Unit/integration tests added
- [ ] No new warnings
- [ ] Works with gRPC calls (frontend) or database queries (backend)

## Ralph Status Block
---RALPH_STATUS---
STATUS: FAILED
COMPLEXITY: medium
WSJF: 10
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 10:02:54 CET 2026)
```
      }
    } catch (err) {
      console.error('Failed to toggle schedule:', err);
      // Mock update
      schedules = schedules.map(s =>
        s.id === schedule.id ? { ...s, enabled: !s.enabled } : s
      );
    }
  }

  async function deleteSchedule(schedule: Schedule) {
    if (!confirm('Supprimer cette planification ?')) return;

    try {
      const res = await fetch(`/api/admin/reports/schedules/${schedule.id}`, {
        method: 'DELETE'
      });

      if (res.ok) {
        awai
```

## Last Failure (Wed Jan 14 10:03:25 CET 2026)
```
  }

  interface Tenant {
    id: string;
    name: string;
    code: string;
  }

  interface Schedule {
    id: str

=== LLM Response ===
<think>
Now I have a better picture. The frontend uses gRPC. Let me explore the api folder and grpc folder to understand how API calls are made, and also look at the full +page.svelte file to understand what functions are being called.
</think>

<bash command="ls -la veligo-platform/frontend/src/lib/api/"/>
<bash command="ls -la veligo-platform/frontend/src/lib/grpc/"/>
<bash command="cat veligo-platform/frontend/src/routes/\(admin\)/reports/+page.svelte | head -200"/>
<bash command="cat veligo-platform/frontend/src/routes/\(admin\)/reports/+page.svelte | tail -300"/>
```

## Last Failure (Wed Jan 14 10:04:24 CET 2026)
```
bash: OK
File not found

---
bash: OK
/**
 * Tenant-Aware API Client
 *
 * Centralized fetch wrapper that automatically includes tenant context
 * in all requests via X-Tenant-ID header.
 */

import { get as getStore } from 'svelte/store';
import { browser } from '$app/environment';
import { tenantStore } from '$lib/stores/tenant';
import { getEndpoint } from './endpoints';
import { transformResponse, type TransformContext } from './transformers';

// ============================================================================
// Ty
```

## Last Failure (Wed Jan 14 10:05:08 CET 2026)
```
service ReportService {
  // Dashboard Stats
  rpc GetDashboardStats(GetDashboardStatsRequest) returns (GetDashboardStatsResponse);

  // Report Generation
  rpc GenerateReport(GenerateReportRequest) returns (GenerateReportResponse);
  rpc GetReportStatus(GetReportStatusRequest) returns (GetReportStatusResponse);
  rpc ListReports(ListReportsRequest) returns (ListR
---
bash: OK
total 344
drwxr-xr-x  18 sylvain  staff     576 Jan  7 09:37 .
drwxr-xr-x  20 sylvain  staff     640 Jan  7 09:37 ..
drwxr-xr-x   3 sylvain  staff      96 Dec 19 10:22 auth
drwxr-xr-x   3 sylvain  staff      96 Jan  1 14:18 bike
-rw-r--r--   1 sylvain  staff    8027 Jan  3 20:32 bike.ts
drwxr-xr-x   3 sylvain  staff      96 Jan  1 13:41 booking
-rw-r--r--   1 sylvain  staff    6188 Jan  3 20:26 booking.ts
-rw-r--r--   1 sylvain  staff    9467 Jan  7 09:37 client.ts
drwxr-xr-x   3 sylvain  staff 
```

## Last Failure (Wed Jan 14 10:08:25 CET 2026)
```
<bash command="cat veligo-platform/frontend/src/routes/\(admin\)/reports/+page.server.ts 2>/dev/null || echo "FILE NOT FOUND""/>
<bash command="wc -l veligo-platform/frontend/src/routes/\(admin\)/reports/+page.server.ts 2>/dev/null || echo "0""/>
<bash command="cd veligo-platform/frontend && pwd"/>
<bash command="ls -la src/routes/ 2>/dev/null | head -20"/>
<bash command="ls -la src/routes/\(admin\)/ 2>/dev/null | head -20"/>
<bash command="ls -la src/routes/\(admin\)/reports/ 2>/dev/null | head -20"/>
<bash command="cat src/routes/\(admin\)/reports/+page.server.ts 2>/dev/null | head -20 || echo "NOT FOUND""/>
<bash command="pwd && ls -la"/>
<bash command="find . -name "+page.server.ts" -path "*/reports/*" 2>/dev/null"/>
<bash command="find veligo-platform -name "+page.server.ts" -path "*/reports/*" 2>/dev/null"/>
<bash command="ls -la veligo-platform/frontend/src/routes/\(admin\)/reports/ 2>/dev/null || echo "dir not found""/>
<bash command="cat veligo-platform/frontend/src/routes/\(admin\)/reports/+page.server.ts 2>/dev/null || echo "file not found""/>
<bash command="mkdir -p veligo-platform/frontend/src/routes/\(admin\)/reports && ls -la veligo-platform/frontend/src/routes/\(admin\)/reports/"/>
<bash command="echo 'test content' > veligo-platform/frontend/src/routes/\(admin\)/reports/+page.server.ts && cat veligo-platform/frontend/src/routes/\(admin\)/reports/+page.server.ts"/>
<bash command="rm veligo-platform/frontend/src/routes/\(admin\)/reports/+page.server.ts && ls -la veligo-platform/frontend/src/routes/\(admin\)/reports/"/>
<bash command="pwd"/>
<bash command="ls -la"/>
<bash command="ls -la veligo-platform/"/>
<bash command="ls -la veligo-platform/frontend/"/>
<bash com
```

## Last Failure (Wed Jan 14 10:13:56 CET 2026)
```
<bash command="cat > veligo-platform/frontend/src/routes/\(admin\)/reports/+page.server.ts << 'EOF'
import type { PageServerLoad, Actions } from './$types';
import { fail } from '@sveltejs/kit';
import { z } from 'zod';

export const load: PageServerLoad = async ({ locals }) => {
  const tenantId = locals.tenantId;
  if (!tenantId) {
    return { reports: [], error: 'Tenant not found' };
  }
  try {
    const response = await locals.apiClient.reports.listReports({ tenantId });
    return { reports: response.reports || [], error: null };
  } catch (err) {
    console.error('Failed to load reports:', err);
    return { reports: [], error: 'Failed to load reports' };
  }
};

const generateRepo
```
