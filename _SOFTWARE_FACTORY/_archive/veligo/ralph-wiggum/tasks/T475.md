# Task T475: Extension r√©servation en cours

**Priority**: P2
**WSJF Score**: 6.8
**Queue**: TDD
**Category**: JOURNEY
**Original ID**: J-E2E-011
**Phase**: üö¥ PHASE 1: JOURNEYS E2E ESSENTIELS (Priority P0)
**Section**: 1.3 Booking V√©lo

## Description
Extension r√©servation en cours

## Test File
`journeys/111-extend-reservation.spec.ts`

## Estimated Files
3 fichier(s) √† modifier

## Success Criteria
- [ ] Test E2E cr√©√©/modifi√©: `journeys/111-extend-reservation.spec.ts`
- [ ] Test passe en local
- [ ] Pas de test.skip() sans condition
- [ ] Code review adversarial pass√©
- [ ] Pas de stubs ou TODOs

## Definition of Done (DoD)
- [ ] Feature compl√®tement impl√©ment√©e
- [ ] Tests E2E verts
- [ ] Conformit√© AO v√©rifi√©e (si applicable)
- [ ] Documentation mise √† jour

## Ralph Status Block
---RALPH_STATUS---
STATUS: FAILED
COMPLEXITY: medium
WSJF: 6.8
CATEGORY: JOURNEY
ORIGINAL_ID: J-E2E-011
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 14:14:22 CET 2026)
```
Let me explore more about the booking functionality and existing tests to understand what "extend reservation" means in this context.
</think>

<bash>
find /Users/sylvain/_LAPOSTE/_VELIGO2 -type f -name "*.spec.ts" -path "*journeys*" | xargs grep -l "extend\|prolong" 2>/dev/null | head -5</bash>
<bash>
find /Users/sylvain/_LAPOSTE/_VELIGO2 -type f -name "*.spec.ts" -path "*journeys*" | xargs grep -l "110\|111\|112" 2>/dev/null | head -10</bash>

=== Action Results ===
bash: OK
/Users/sylvain/_LAPOSTE/_VELIGO2/tests/e2e/journeys/01-auth-journeys-ao-enhanced-v2.spec.ts
/Users/sylvain/_LAPOSTE/_VELIGO2/tests/e2e/journeys/04-bike-booking.spec.ts

---
bash: OK
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/frontend/tests/journeys/09-bike-return.spec.ts
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/tests/e2e/journeys/09-bike-return.spec.ts
/Users/sylvain/_LAPOSTE/_VELIGO2/tests/e2e/user-journeys-complete.spec.ts
/Users/sylvain/_LAPOSTE/_VELIGO2/tests/e2e/journeys/nantes-box-securises-full.spec.ts
/Users/sylvain/_LAPOSTE/_VELIGO2/tests/e2e/journeys/03-payment-flow-ao-enhanced.spec.ts
```

## Last Failure (Wed Jan 14 14:15:48 CET 2026)
```
=== Action Results ===
bash: OK
/**
 * E2E Journey Tests - Booking Complete
 * TDD Red Phase - Real selectors, real fixtures, real API calls
 *
 * Personas tested:
 * - USER_IDFM: User with active subscription, can book bikes
 * - USER_NANTES: User with Naolib integration
 * - USER_LYON: User with TCL multimodal integration
 *
 * Journeys covered:
 * 1. Browse stations (map + list)
 * 2. Select station
 * 3. Select bike
 * 4. Choose time slot
 * 5. Confirm booking
 * 6. Pickup instructions
 * 7. Cancel booking
 * 8. Booking hi
```

## Last Failure (Wed Jan 14 14:16:36 CET 2026)
```
</think>

<bash>
tail -200 /Users/sylvain/_LAPOSTE/_VELIGO2/tests/e2e/journeys/04-bike-booking.spec.ts</bash>

=== Action Results ===
bash: OK
    // Select extension duration
    await page.click('[data-testid="extend-1hour"]');
    
    const additionalCost = page.locator('[data-testid="additional-cost"]');
    await expect(additionalCost).toContainText('‚Ç¨3.00');
    
    await page.click('[data-testid="confirm-extend"]');
    
    const extendResponse = await page.waitForResponse(r => r.url().includes('/bike.BikeService/ExtendRental'));
    expect(extendResponse.ok()).toBe(true);
    
    // New end time should be updated
    await 
```
