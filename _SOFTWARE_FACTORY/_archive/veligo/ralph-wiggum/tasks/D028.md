# Task D028: Implémenter UserService handlers (auth-service)

**Priority**: P1
**Time Estimate**: 6h
**WSJF Score**: 7.0
**Complexity**: medium
**Queue**: BACKEND

## Description
Implémenter TODO dans veligo-auth-service/handlers.rs pour login DB lookup, session revocation, et MFA.

## Success Criteria
- [ ] Login utilise真实的数据库查询
- [ ] Logout révoque session en DB/Redis
- [ ] MFA secret récupéré depuis DB
- [ ] Tests d'intégration auth

## Actions
1. Créer AuthRepository pour user lookup
2. Implémenter login avec password verification
3. Implémenter logout avec session revocation
4. Ajouter MFA secret handling
5. Créer tests d'intégration

## Files to Create/Modify
- [ ] veligo-platform/services/veligo-auth-service/src/repository.rs (CREATE)
- [ ] veligo-platform/services/veligo-auth-service/src/handlers.rs (MODIFY)
- [ ] veligo-platform/services/veligo-auth-service/tests/auth_tests.rs (CREATE)

## Ralph Status Block
---RALPH_STATUS---
STATUS: IN_PROGRESS
COMPLEXITY: medium
MODEL_TIER: TIER2
WSJF: 7.0
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 18:14:12 CET 2026)
```

=== LLM Response ===
<think>
The auth service exists. Let me read the existing files to understand what's there and what needs to be implemented.
</think>

<read file="veligo-platform/services/veligo-auth-service/src/handlers.rs"/>
<read file="veligo-platform/services/veligo-auth-service/src/repository.rs"/>
<read file="veligo-platform/services/veligo-auth-service/src/lib.rs"/>
<read file="veligo-platform/services/veligo-auth-service/src/domain.rs"/></read>

=== LLM Response ===
<think>
Let me read the existing files to understand the current state and what needs to be implemented.
</think>

<read file="veligo-platform/services/veligo-auth-service/src/handlers.rs"/>
<read file="veligo-platform/services/veligo-auth-service/src/repository.rs"/>
<read file="veligo-platform/services/veligo-auth-service/src/lib.rs"/>
<read file="veligo-platform/services/veligo-auth-service/src/domain.rs"/></read>
```

## Last Failure (Wed Jan 14 18:14:53 CET 2026)
```
    pub password_service: PasswordService,
    pub totp_service: TotpService,
    pub config: AuthConfig,
}

/// Create the auth service

=== LLM Response ===
<think>
The output keeps getting cut off. Let me try to read the file in a different way.
</think>

```bash
cat -A veligo-platform/services/veligo-auth-service/src/handlers.rs | head -200
```

=== Action Results ===
bash: OK
cat: illegal option -- A
usage: cat [-belnstuv] [file ...]
```
