# Task T1239: Fix +layout.ts - retourner tenant.id (UUID)

**Priority**: P0
**Time Estimate**: 45m
**WSJF Score**: 14.0
**Complexity**: medium
**Queue**: TDD

## Description
Le layout frontend ne retourne que `tenant.slug` mais les pages attendent `tenant.id` (UUID) ou `tenantId`.

Actuellement:
```typescript
return { tenant: { slug: "idfm" } }
```

Les pages font:
```typescript
const tenantId = $page.data.tenantId || 'default';  // N'existe pas!
$: tenantId = $page.data.tenant?.id || 'default';   // N'existe pas!
```

Il faut soit:
1. Ajouter tenant.id dans le retour du layout (lookup slug ‚Üí UUID)
2. Ou modifier les pages pour utiliser tenant.slug

## Success Criteria
- [ ] $page.data.tenant.id retourne un UUID valide
- [ ] OU les pages utilisent tenant.slug avec resolve c√¥t√© backend
- [ ] Plus de fallback 'default' utilis√©
- [ ] Tests E2E subscription passent

## Actions
1. Modifier veligo-platform/frontend/src/routes/(app)/+layout.ts
2. Option A: Ajouter appel API pour r√©cup√©rer UUID depuis slug
3. Option B: Stocker mapping slug‚ÜíUUID c√¥t√© frontend
4. Mettre √† jour toutes les pages qui utilisent tenantId

## Files to Create/Modify
- [ ] veligo-platform/frontend/src/routes/(app)/+layout.ts (MODIFY)
- [ ] veligo-platform/frontend/src/routes/(app)/subscriptions/new/+page.svelte (MODIFY)
- [ ] veligo-platform/frontend/src/routes/(app)/checkout/payment/+page.svelte (MODIFY)

## Ralph Status Block
---RALPH_STATUS---
STATUS: FAILED
COMPLEXITY: medium
MODEL_TIER: TIER1
WSJF: 14.0
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 20:45:18 CET 2026)
```
[0;32m[AGENT] Real Agent starting[0m
[0;34m[AGENT] Task: /Users/sylvain/_LAPOSTE/_VELIGO2/tools/ralph-wiggum/tasks/T1239.md[0m
[0;34m[AGENT] Queue: tdd[0m
[0;34m[AGENT] Backend: auto[0m
[0;32m[AGENT] Starting task: T1239[0m
[0;34m[AGENT] Iteration 1/10[0m
[0;31m[AGENT] Local LLM failed: HTTPConnectionPool(host='127.0.0.1', port=8002): Read timed out. (read timeout=300)[0m

============================================================
RESULT: FAILED
============================================================
ERROR: LLM call failed
```

## Last Failure (Wed Jan 14 20:50:19 CET 2026)
```
[0;32m[AGENT] Real Agent starting[0m
[0;34m[AGENT] Task: /Users/sylvain/_LAPOSTE/_VELIGO2/tools/ralph-wiggum/tasks/T1239.md[0m
[0;34m[AGENT] Queue: tdd[0m
[0;34m[AGENT] Backend: auto[0m
[0;32m[AGENT] Starting task: T1239[0m
[0;34m[AGENT] Iteration 1/10[0m

============================================================
RESULT: FAILED
============================================================
ERROR: LLM call failed
```

## Last Failure (Wed Jan 14 20:54:25 CET 2026)
```
[0;32m[AGENT] Real Agent starting[0m
[0;34m[AGENT] Task: /Users/sylvain/_LAPOSTE/_VELIGO2/tools/ralph-wiggum/tasks/T1239.md[0m
[0;34m[AGENT] Queue: tdd[0m
[0;34m[AGENT] Backend: auto[0m
[0;32m[AGENT] Starting task: T1239[0m
[0;34m[AGENT] Iteration 1/10[0m

============================================================
RESULT: FAILED
============================================================
ERROR: LLM call failed
```
