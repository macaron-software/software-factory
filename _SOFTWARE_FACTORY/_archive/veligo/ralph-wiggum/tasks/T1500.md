# Task T1500: Add error handling for null/empty payment methods in payment

**Priority**: P1
**WSJF Score**: 8.0
**Queue**: TDD
**Parent**: T1256
**Generated by**: Fractal LLM Delegation

## Description
Add error handling for null/empty payment methods in payment_handler.rs

## Reason for Delegation
Task requires 8 files across backend+tests with complex interactions involving dependency injection, factory pattern, and test isolation. Touches multiple domains and exceeds 400 LOC.

## Success Criteria
- [ ] Task completed
- [ ] Tests pass
- [ ] No stubs or TODOs

## Ralph Status Block
---RALPH_STATUS---
STATUS: FAILED
COMPLEXITY: medium
PARENT_TASK: T1256
---END_RALPH_STATUS---

## Last Failure (Thu Jan 15 07:04:59 CET 2026)
```
- `test_stripe_api_error_payment_method_required`
- `test_stripe_api_error_payment_method_empty`

### 2. `veligo-platform/backend/tests/integration/payment_tests.rs`

Updated `test_add_payment_method_empty_id` to expect `BAD_REQUEST` instead of accepting CREATED.

### 3. `veligo-platform/backend/tests/api/payment_test.rs`

Updated `test_add_payment_method_empty_id` to expect `BAD_REQUEST` instead of multiple acceptable statuses.

The implementation now properly validates that payment method IDs are not empty strings and returns appropriate `400 BAD_REQUEST` responses with descriptive error messages when validation fails.
[96m[1m| [0m[90m Read     [0mtools/ralph-wiggum/tasks/T1500.md
[94m[1m| [0m[90m Glob     [0m{"pattern":"**/payment_handler.rs"}
[94m[1m| [0m[90m Glob     [0m{"pattern":"**/payment*.rs"}
[96m[1m| [0m[90m Read     [0mveligo-platform/backend/src/api/payment_api.rs
[96m[1m| [0m[90m Read     [0mveligo-platform/backend/src/domain/payment/payment.rs
[96m[1m| [0m[90m Read     [0mv

ERROR: LLM call failed
```
