# Task T1090: Ensure dependency injection is properly tested via DI contai

**Priority**: P1
**WSJF Score**: 8.0
**Queue**: TDD
**Parent**: T1036
**Generated by**: Fractal LLM Delegation

## Description
Ensure dependency injection is properly tested via DI container or builder pattern

## Reason for Delegation
Task requires unit tests for PaymentAdapterFactory with dependency injection mocks across multiple files (PaymentAdapterFactory, PayPalProcessor, StripeProcessor, PaymentProcessor trait, and test files) with proper test isolation, mock dependencies, and integration of dependency injection. Estimated LOC >400, files >5, multiple domains (payment processing, factory pattern, DI, testing).

## Success Criteria
- [ ] Task completed
- [ ] Tests pass
- [ ] No stubs or TODOs

## Ralph Status Block
---RALPH_STATUS---
STATUS: FAILED
COMPLEXITY: medium
PARENT_TASK: T1036
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 20:24:07 CET 2026)
```
#[derive(Debug, Clone)]
pub struct MockPaymentAdapter {
    pub transaction_id: String,
    pub should_fail: bool,
}

impl Default for MockPaymentAdapter {
    fn default() -> Self {
        Self {
            transaction_id: "mock_tx_123456".to_string(),
      
---
bash: OK
total 24
drwxr-xr-x   6 sylvain  staff   192 Jan 14 19:20 .
drwxr-xr-x  24 sylvain  staff   768 Jan 14 18:02 ..
-rw-r--r--   1 sylvain  staff  3726 Jan 14 19:45 adapter.rs
drwxr-xr-x   4 sylvain  staff   128 Jan 14 18:07 adapters
-rw-r--r--   1 sylvain  staff    41 Jan 14 20:23 mod.rs
-rw-r--r--   1 sylvain  staff    66 Jan 14 20:23 paypal_processor.rs
```

## Last Failure (Wed Jan 14 20:24:37 CET 2026)
```
```

=== Action Results ===
bash: OK
//! Unit tests for PayPalAdapter
//! Tests edge cases: invalid credentials, API timeouts, invalid transaction data

#[cfg(test)]
mod paypal_adapter_tests {
    use std::time::Duration;
    use tokio::time::timeout;
    use veligo_backend::payment::adapters::paypal::PayPalAdapter;
    use veligo_backend::payment::{PaymentAdapter, PaymentError};

    // Helper to create adapter for testing
    fn create_test_adapter() -> PayPalAdapter {
        PayPalAdapter
    }

    // =========================
```

## Last Failure (Wed Jan 14 20:25:23 CET 2026)
```

<bash>cat ./veligo-platform/tenant/backend-api/src/infrastructure/adapters/payment/factory.rs</bash>

=== Action Results ===
bash: OK
// Trace: Sprint 004 - 2025-12-11T12:46:10Z - Payment Adapter Factory

use super::mock_adapter::MockPaymentAdapter;
use crate::domain::payment::{PaymentError, PaymentPort, PaymentProvider};
use std::sync::Arc;

/// Payment Adapter Factory
///
/// Selects the appropriate payment provider based on tenant configuration.
/// This enables multi-tenant support where different tenants can use different payment providers.
///
/// Example tenant config:
/// ```json
/// {
///   "tenant_id": "veligo-paris"
```
