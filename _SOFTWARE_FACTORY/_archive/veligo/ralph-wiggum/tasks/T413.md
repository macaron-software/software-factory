# Task T413: Souscription SEPA avec mandat

**Priority**: P1
**WSJF Score**: 8.3
**Queue**: TDD
**Category**: JOURNEY
**Original ID**: J-E2E-006
**Phase**: üö¥ PHASE 1: JOURNEYS E2E ESSENTIELS (Priority P0)
**Section**: 1.2 Souscription & Paiement

## Description
Souscription SEPA avec mandat

## Test File
`journeys/106-sepa-mandate.spec.ts`

## Estimated Files
3 fichier(s) √† modifier

## Success Criteria
- [ ] Test E2E cr√©√©/modifi√©: `journeys/106-sepa-mandate.spec.ts`
- [ ] Test passe en local
- [ ] Pas de test.skip() sans condition
- [ ] Code review adversarial pass√©
- [ ] Pas de stubs ou TODOs

## Definition of Done (DoD)
- [ ] Feature compl√®tement impl√©ment√©e
- [ ] Tests E2E verts
- [ ] Conformit√© AO v√©rifi√©e (si applicable)
- [ ] Documentation mise √† jour

## Ralph Status Block
---RALPH_STATUS---
STATUS: FAILED
COMPLEXITY: medium
WSJF: 8.3
CATEGORY: JOURNEY
ORIGINAL_ID: J-E2E-006
---END_RALPH_STATUS---

## Last Failure (Wed Jan 14 13:32:55 CET 2026)
```
-rw-------    1 sylvain  staff     433 Jan  3 19:31 .dockerignore
-rw-------    1 sylvain  staff    7623 Dec 26 22:36 .env.example
-rw-r--r--    1 sylvain  staff    2763 Dec 26 17:56 .env.prod.example
drwxr-xr-x    3 sylvain  staff      96 Dec 10 14:34 .github
-rw-r--r--    1 sylvain  staff      92 Dec 29 12:47 .gitignore
-rw-r--r--    1 sylvain  staff   11699 Dec 11 13:35 ADAPT

=== LLM Response ===
<think>
Good, I found the veligo-platform. Let me explore its structure to find the E2E tests directory.
</think>

<bash>
ls -la /Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/ | grep -E "test|journey|e2e"</bash>

=== Action Results ===
bash: OK
-rw-r--r--    1 sylvain  staff    2025 Jan  7 09:37 docker-compose.test.yml
drwxr-xr-x    3 sylvain  staff      96 Dec 30 19:33 test-results
drwxr-xr-x    5 sylvain  staff     160 Jan  4 16:03 tests
```

## Last Failure (Wed Jan 14 13:33:38 CET 2026)
```
 * 2. Select plan
 * 3. Apply subsidy (IDFM, Nantes)
 * 4. Payment flow (Stripe/Paynum)
 * 5. Subscription confirmation
 * 6. Subscription managem

=== LLM Response ===
<think>
Let me also check the helpers to understand the testing patterns used in this project.
</think>

<bash>
ls -la /Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/frontend/tests/helpers/</bash>

=== Action Results ===
bash: OK
total 8
drwxr-xr-x  3 sylvain  staff    96 Dec 31 10:36 .
drwxr-xr-x  8 sylvain  staff   256 Dec 31 10:35 ..
-rw-------  1 sylvain  staff  3385 Dec 31 10:36 auth.helper.ts
```

## Last Failure (Wed Jan 14 13:34:12 CET 2026)
```
cat "/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/frontend/tests/journeys/subscription.journey.spec.ts"</bash>

=== Action Results ===
bash: OK
/**
 * E2E Journey Tests - Subscription Complete
 * TDD Red Phase - Real selectors, real fixtures, real API calls
 *
 * Personas tested:
 * - USER_IDFM: Eligible for IDFM subsidy (50% up to 500EUR)
 * - USER_NANTES: Eligible for Nantes Metropole subsidy (40% up to 300EUR)
 * - USER_LYON: No specific subsidy
 *
 * Journeys covered:
 * 1. Browse catalog
 * 2. Select plan
 * 3. Apply subsidy (IDFM, Nantes)
 * 4. Payment flow (Stripe/Paynum)
 * 5. Subscription confirmation
 * 6. Subscription managem
```
