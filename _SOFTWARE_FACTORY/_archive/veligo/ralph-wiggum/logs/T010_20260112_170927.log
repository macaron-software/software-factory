[96m[1m| [0m[90m Read     [0mveligo-platform/tests/e2e/journeys/20-referral-program.spec.ts
[94m[1m| [0m[90m Glob     [0m{"pattern":"**/referral-program/**/*"}
[91m[1m| [0m[90m Bash     [0mList veligo-platform directory

total 848
drwxr-xr-x   56 sylvain  staff    1792 Jan  7 09:37 .
drwxr-xr-x  230 sylvain  staff    7360 Jan 12 17:00 ..
-rw-------    1 sylvain  staff     433 Jan  3 19:31 .dockerignore
-rw-------    1 sylvain  staff    7623 Dec 26 22:36 .env.example
-rw-r--r--    1 sylvain  staff    2763 Dec 26 17:56 .env.prod.example
drwxr-xr-x    3 sylvain  staff      96 Dec 10 14:34 .github
-rw-r--r--    1 sylvain  staff      92 Dec 29 12:47 .gitignore
-rw-r--r--    1 sylvain  staff   11699 Dec 11 13:35 ADAPTERS-STRATEGY.md
-rw-r--r--    1 sylvain  staff  174998 Jan  7 09:37 Cargo.lock
-rw-------    1 sylvain  staff    2805 Jan  3 13:32 Cargo.toml
-rw-r--r--    1 sylvain  staff    1924 Jan  3 20:33 DEPLOYMENT-NOTES.md
-rw-r--r--    1 sylvain  staff   10671 Dec 10 21:11 DEPLOYMENT.md
-rw-r--r--    1 sylvain  staff    1862 Jan  3 16:52 DEPLOY_NGINX_FIX.md
-rw-r--r--    1 sylvain  staff    2233 Dec 30 15:25 Dockerfile.backend
-rw-------    1 sylvain  staff    3171 Dec 29 12:40 Dockerfile.backend.optimized
-rw-r--r--    1 sylvain  staff   18458 Dec 10 15:02 IMPLEMENTATION-COMPLETE.md
-rw-r--r--    1 sylvain  staff   10416 Dec 12 09:47 MODULAR-SWARM-ARCHITECTURE.md
-rw-r--r--    1 sylvain  staff   11341 Dec 11 13:51 PAYMENT-ARCHITECTURE.md
-rw-r--r--    1 sylvain  staff    7692 Dec 11 20:11 PLUGIN-ARCHITECTURE-PHASE3-COMPLETE.md
-rw-r--r--    1 sylvain  staff    7020 Dec 11 19:50 QUICKSTART-PLUGIN-SYSTEM.md
-rw-r--r--    1 sylvain  staff   16861 Dec 26 18:00 README.md
-rw-r--r--    1 sylvain  staff    9675 Dec 12 07:59 SPRINT-005-DAY-4-E2E-JAEGER-GUIDE.md
-rw-r--r--    1 sylvain  staff   12815 Jan  3 14:41 SPRINT-ANALYSIS.md
-rw-r--r--    1 sylvain  staff   34460 Jan  3 20:45 SPRINT-NEXT.md
-rw-------    1 sylvain  staff   11423 Dec 26 18:39 VERIFICATION-REPORT.md
drwxr-xr-x    4 sylvain  staff     128 Dec 16 23:19 api-gateway
drwxr-xr-x   24 sylvain  staff     768 Jan  9 12:17 backend
drwxr-xr-x    2 sylvain  staff      64 Dec 26 08:39 certs
drwxr-xr-x    5 sylvain  staff     160 Dec 26 17:55 config
drwxr-xr-x    9 sylvain  staff     288 Dec 20 11:06 design-system
drwxr-xr-x   10 sylvain  staff     320 Jan  7 09:37 docker
-rw-r--r--    1 sylvain  staff    1909 Jan  7 09:37 docker-compose.dev.yml
-rw-r--r--    1 sylvain  staff    1086 Dec 12 07:58 docker-compose.jaeger.yml
-rw-r--r--    1 sylvain  staff   12584 Dec 26 17:57 docker-compose.prod.yml
-rw-r--r--    1 sylvain  staff    2025 Jan  7 09:37 docker-compose.test.yml
-rw-r--r--    1 sylvain  staff    2913 Jan  3 14:48 docker-compose.yml
drwxr-xr-x   10 sylvain  staff     320 Dec 26 18:41 docs
drwxr-xr-x   26 sylvain  staff     832 Jan 12 15:09 frontend
drwxr-xr-x    3 sylvain  staff      96 Jan  3 13:25 infrastructure
drwxr-xr-x    3 sylvain  staff      96 Dec 29 12:41 libs
drwxr-xr-x   11 sylvain  staff     352 Jan  7 09:37 migrations
drwxr-xr-x    6 sylvain  staff     192 Dec 12 09:38 modules
drwxr-xr-x    8 sylvain  staff     256 Dec 26 18:40 monitoring
drwxr-xr-x    7 sylvain  staff     224 Dec 31 20:16 nginx
drwxr-xr-x    4 sylvain  staff     128 Dec 15 16:19 owner
drwxr-xr-x   19 sylvain  staff     608 Jan  1 14:16 proto
drwxr-xr-x   25 sylvain  staff     800 Jan  7 09:37 scripts
drwx------    3 sylvain  staff      96 Dec 26 18:39 security-reports
drwxr-xr-x    3 sylvain  staff      96 Dec 29 12:41 services
drwxr-xr-x    3 sylvain  staff      96 Dec 17 10:35 store
drwxr-xr-x    3 sylvain  staff      96 Dec 26 17:35 systemd
drwxr-xr-x@   7 sylvain  staff     224 Jan  3 20:42 target
drwxr-xr-x    5 sylvain  staff     160 Dec 15 16:19 tenant
drwxr-xr-x    3 sylvain  staff      96 Dec 30 19:33 test-results
drwxr-xr-x    5 sylvain  staff     160 Jan  4 16:03 tests
lrwxr-xr-x    1 sylvain  staff      70 Dec 28 18:15 veligo -> /Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/scripts/veligo-cli.sh

[94m[1m| [0m[90m Glob     [0mveligo-platform/frontend
[91m[1m| [0m[90m Bash     [0mFind backend directory

drwxr-xr-x    5 sylvain  staff     160 Dec 24 13:26 .veligo
-rwxr-xr-x    1 sylvain  staff   13573 Dec 16 09:37 .veligo-complete-pipeline.sh
-rwxr-xr-x    1 sylvain  staff    3534 Dec 16 09:37 .veligo-frontend-pipeline.sh
-rwxr-xr-x    1 sylvain  staff    3885 Dec 16 09:37 .veligo-pipeline.sh
-rwxr-xr-x    1 sylvain  staff    3000 Dec 16 09:37 .veligo-tdd-pipeline.sh
drwxr-xr-x@   3 sylvain  staff      96 Dec 26 00:34 backend
-rw-r--r--    1 sylvain  staff    4485 Dec 12 12:01 crontab-veligo.txt
-rwx--x--x    1 sylvain  staff   24666 Dec 25 23:34 launch-veligo-agents.sh
lrwxr-xr-x    1 sylvain  staff      21 Dec 14 15:35 veligo -> target/release/veligo
drwxr-xr-x    7 sylvain  staff     224 Dec 14 11:10 veligo-cli
drwxr-xr-x   56 sylvain  staff    1792 Jan  7 09:37 veligo-platform
drwxr-xr-x   10 sylvain  staff     320 Dec 16 22:07 veligo-store
drwxr-xr-x   10 sylvain  staff     320 Dec 12 12:14 veligo-templates

[96m[1m| [0m[90m Read     [0mveligo-platform/frontend/src/routes/referral/+page.svelte
[94m[1m| [0m[90m Glob     [0mveligo-platform/frontend/src/lib
[91m[1m| [0m[90m Bash     [0mList backend directory

total 0
drwxr-xr-x@   3 sylvain  staff    96 Dec 26 00:34 .
drwxr-xr-x  230 sylvain  staff  7360 Jan 12 17:00 ..
drwxr-xr-x   31 sylvain  staff   992 Dec 26 00:34 .sqlx

[96m[1m| [0m[90m Read     [0mveligo-platform/frontend/src/lib/api/referral.ts
[91m[1m| [0m[90m Bash     [0mList backend src

ls: /Users/sylvain/_LAPOSTE/_VELIGO2/backend/src/: No such file or directory

[91m[1m| [0m[90m Bash     [0mList veligo-platform backend

total 392
drwxr-xr-x  24 sylvain  staff     768 Jan  9 12:17 .
drwxr-xr-x  56 sylvain  staff    1792 Jan  7 09:37 ..
-rw-r--r--   1 sylvain  staff     241 Dec 25 23:09 .env
-rw-r--r--   1 sylvain  staff     722 Dec 10 14:51 .env.example
-rw-r--r--   1 sylvain  staff      65 Dec 25 23:14 .env.sqlx
drwxr-xr-x  39 sylvain  staff    1248 Dec 27 12:15 .sqlx
-rw-r--r--   1 sylvain  staff  152996 Dec 29 09:12 Cargo.lock
-rw-r--r--   1 sylvain  staff    3895 Jan  7 09:37 Cargo.toml
-rw-r--r--   1 sylvain  staff    2019 Dec 13 20:42 Cargo.toml.bak
-rw-r--r--   1 sylvain  staff       0 Dec 12 20:43 Cargo.toml.tmp
-rw-r--r--   1 sylvain  staff    3879 Dec 11 18:56 PHASE-2-4-INTEGRATION-COMPLETE.md
-rw-r--r--   1 sylvain  staff    7638 Jan  9 12:17 PLAN-US-001-AUTH.md
-rw-r--r--   1 sylvain  staff    3804 Dec 27 13:53 SQLX-CONVERSION-SUMMARY.md
drwxr-xr-x   3 sylvain  staff      96 Dec 27 12:55 backend
-rw-r--r--   1 sylvain  staff    1074 Jan  3 20:31 build.rs
drwxr-xr-x   5 sylvain  staff     160 Dec 26 17:58 config
-rwx--x--x   1 sylvain  staff    1501 Dec 27 18:10 fix_pgrow.sh
drwxr-xr-x  67 sylvain  staff    2144 Jan  7 09:37 migrations
drwx------   9 sylvain  staff     288 Dec 29 13:10 scripts
drwxr-xr-x   4 sylvain  staff     128 Dec 16 09:37 seeds
drwxr-xr-x  20 sylvain  staff     640 Jan  9 08:55 src
drwxrwxrwx@  6 sylvain  staff     192 Dec 30 15:25 target
drwxr-xr-x  15 sylvain  staff     480 Dec 27 11:29 tests
drwxr-xr-x   5 sylvain  staff     160 Jan  7 09:37 tonic-server

[91m[1m| [0m[90m Bash     [0mFind Rust source files

/Users/sylvain/_LAPOSTE/_VELIGO2/tenant/backend/src/main.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-templates/generators/src/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/owner/backend/src/main.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/tenant/backend-api/target/release/build/crunchy-13c8a58fdefedd4e/out/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/tenant/backend-api/target/release/build/crunchy-893c5c81c7b68802/out/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/tenant/backend-api/target/release/build/crunchy-6caaf7d8a5af7e69/out/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/tenant/backend-api/target/debug/build/crunchy-e83d32f23b3df36a/out/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/tenant/backend-api/target/debug/build/crunchy-6204baf7e1ec1532/out/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/tenant/backend-api/target/debug/build/crunchy-dbe519f41df9809e/out/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/tenant/backend-api/tonic-server/src/main.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/tenant/backend-api/src/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/owner/backend/target/release/build/crunchy-13c8a58fdefedd4e/out/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/owner/backend/target/release/build/crunchy-893c5c81c7b68802/out/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/owner/backend/target/release/build/crunchy-6caaf7d8a5af7e69/out/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/owner/backend/src/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/api-gateway/src/main.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/target/release/build/crunchy-3767dd521d5328b3/out/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/target/release/build/crunchy-893c5c81c7b68802/out/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/target/release/build/crunchy-6caaf7d8a5af7e69/out/lib.rs
/Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/target/debug/build/crunchy-e83d32f23b3df36a/out/lib.rs

[91m[1m| [0m[90m Bash     [0mList backend src directory

total 16
drwxr-xr-x  20 sylvain  staff   640 Jan  9 08:55 .
drwxr-xr-x  24 sylvain  staff   768 Jan  9 12:17 ..
drwxr-xr-x  42 sylvain  staff  1344 Jan  7 09:37 api
drwxr-xr-x   6 sylvain  staff   192 Dec 11 18:34 application
drwxr-xr-x   5 sylvain  staff   160 Jan  9 16:41 bin
drwxr-xr-x   5 sylvain  staff   160 Dec 28 02:29 chaos
drwxr-xr-x  19 sylvain  staff   608 Jan  9 08:09 domain
drwxr-xr-x   3 sylvain  staff    96 Dec 29 21:44 error
drwxr-xr-x  10 sylvain  staff   320 Dec 13 20:31 generated
drwxr-xr-x   5 sylvain  staff   160 Dec 29 13:13 grpc
-rw-r--r--   1 sylvain  staff  3343 Dec 27 11:25 grpc_server.rs
drwxr-xr-x   6 sylvain  staff   192 Dec 27 13:50 handlers
drwxr-xr-x  29 sylvain  staff   928 Jan  9 06:55 infrastructure
drwxr-xr-x   4 sylvain  staff   128 Jan  9 08:52 integration
drwxr-xr-x   9 sylvain  staff   288 Dec 31 21:34 jobs
-rw-r--r--   1 sylvain  staff   478 Dec 31 20:45 lib.rs
drwxr-xr-x  10 sylvain  staff   320 Jan 12 13:34 middleware
drwxr-xr-x  49 sylvain  staff  1568 Jan  9 15:41 modules
drwxr-xr-x  23 sylvain  staff   736 Dec 29 22:18 services
drwxr-xr-x   3 sylvain  staff    96 Jan  9 08:55 tests

[91m[1m| [0m[90m Bash     [0mList handlers directory

total 72
drwxr-xr-x   6 sylvain  staff    192 Dec 27 13:50 .
drwxr-xr-x  20 sylvain  staff    640 Jan  9 08:55 ..
drwxr-xr-x  10 sylvain  staff    320 Dec 27 13:50 admin
-rw-r--r--   1 sylvain  staff  14571 Dec 27 13:50 admin_owner.rs
-rw-r--r--   1 sylvain  staff  14587 Dec 27 13:50 admin_owner.rs.bak2
-rw-r--r--   1 sylvain  staff    120 Dec 13 12:34 mod.rs

[91m[1m| [0m[90m Bash     [0mList api directory

total 2072
drwxr-xr-x  42 sylvain  staff   1344 Jan  7 09:37 .
drwxr-xr-x  20 sylvain  staff    640 Jan  9 08:55 ..
-rw-r--r--   1 sylvain  staff  21767 Jan  3 15:12 admin.rs
-rw-------   1 sylvain  staff  50645 Jan  3 20:23 admin_api.rs
-rw-------   1 sylvain  staff  29209 Dec 31 21:30 aom_reporting.rs
-rw-r--r--   1 sylvain  staff  46911 Jan  3 20:30 auth.rs
-rw-------   1 sylvain  staff  27115 Jan  3 20:26 bike_api.rs
-rw-------   1 sylvain  staff  15252 Jan  3 20:34 booking_api.rs
-rw-------   1 sylvain  staff  18158 Dec 31 21:20 booking_api_tdd.rs
-rw-r--r--   1 sylvain  staff  33081 Jan  7 09:37 booking_grpc_web.rs
-rw-------   1 sylvain  staff  13111 Dec 31 21:20 carbon_api.rs
-rw-------   1 sylvain  staff   7595 Dec 28 22:34 catalog_api.rs
-rw-------   1 sylvain  staff  22189 Dec 31 21:21 document_api.rs
-rw-------   1 sylvain  staff  14208 Dec 26 15:29 franceconnect.rs
-rw-------   1 sylvain  staff  58934 Dec 31 21:22 gdpr_api.rs
-rw-------   1 sylvain  staff  13457 Dec 27 11:51 google_oauth.rs
-rw-------   1 sylvain  staff  21186 Dec 27 13:48 health.rs
-rw-------   1 sylvain  staff  20032 Dec 31 21:30 hooks_api.rs
-rw-------   1 sylvain  staff  26219 Dec 31 21:22 mfa.rs
-rw-------   1 sylvain  staff  13689 Dec 26 18:13 microsoft_oauth.rs
drwxr-xr-x   7 sylvain  staff    224 Dec 31 21:33 mobile
-rw-r--r--   1 sylvain  staff   4228 Jan  7 09:37 mod.rs
-rw-------   1 sylvain  staff  30120 Dec 31 21:31 module_management.rs
-rw-r--r--   1 sylvain  staff   5366 Dec 29 22:19 modules.rs
-rw-r--r--   1 sylvain  staff  10784 Dec 27 11:28 openapi.rs
-rw-r--r--   1 sylvain  staff  10035 Dec 31 13:05 owner.rs
-rw-------   1 sylvain  staff  52715 Jan  2 10:20 owner_api.rs
-rw-r--r--   1 sylvain  staff  59314 Dec 31 21:22 payment_api.rs
-rw-------   1 sylvain  staff  11972 Dec 31 21:27 planner_api.rs
-rw-------   1 sylvain  staff    876 Dec 27 20:27 pricing_api.rs
-rw-------   1 sylvain  staff  15931 Dec 31 21:25 referral_api.rs
-rw-------   1 sylvain  staff  23356 Dec 31 21:25 rewards_api.rs
-rw-------   1 sylvain  staff  19536 Jan  3 20:46 station_grpc_web.rs
-rw-------   1 sylvain  staff  57907 Jan  3 14:24 stations.rs
-rw-------   1 sylvain  staff  28208 Dec 31 21:32 stations_hexagonal.rs
-rw-------   1 sylvain  staff   9064 Dec 27 22:14 stations_v2.rs
-rw-r--r--   1 sylvain  staff  46478 Dec 31 21:23 subscription_api.rs
-rw-------   1 sylvain  staff  34085 Jan  3 20:26 subscription_api_e2e.rs
-rw-------   1 sylvain  staff  23604 Dec 31 21:27 tenants.rs
-rw-r--r--   1 sylvain  staff  43619 Jan 12 13:14 test_api.rs
-rw-------   1 sylvain  staff  20095 Dec 31 21:24 ticketing_api.rs
-rw-r--r--   1 sylvain  staff  20071 Dec 30 19:03 validation.rs

[96m[1m| [0m[90m Read     [0mveligo-platform/backend/src/api/mod.rs
[96m[1m| [0m[90m Read     [0mveligo-platform/backend/src/api/referral_api.rs
[91m[1m| [0m[90m Bash     [0mFind referral service

drwxr-xr-x   4 sylvain  staff    128 Dec 29 22:01 referral

[91m[1m| [0m[90m Bash     [0mFind referral migrations
[91m[1m| [0m[90m Bash     [0mList referral service

total 72
drwxr-xr-x   4 sylvain  staff    128 Dec 29 22:01 .
drwxr-xr-x  23 sylvain  staff    736 Dec 29 22:18 ..
-rw-------   1 sylvain  staff    489 Dec 26 18:13 mod.rs
-rw-------   1 sylvain  staff  31898 Dec 29 22:01 referral_service.rs

[96m[1m| [0m[90m Read     [0mveligo-platform/backend/src/services/referral/mod.rs
[96m[1m| [0m[90m Read     [0mveligo-platform/backend/src/services/referral/referral_service.rs
[91m[1m| [0m[90m Bash     [0mCheck last migrations

100_kpi_reporting_indexes.sql
101_add_bikes_gps_columns.sql
20251215_modules_catalog.sql.disabled
disabled
fixtures

[92m[1m| [0m[90m Write    [0mveligo-platform/backend/migrations/102_referral_program.sql
[91m[1m| [0m[90m Bash     [0mFind skipped tests
[91m[1m| [0m[90m Bash     [0mCount tests in file

8

[91m[1m| [0m[90m Bash     [0mCount lines in test file

     152 /Users/sylvain/_LAPOSTE/_VELIGO2/veligo-platform/tests/e2e/journeys/20-referral-program.spec.ts

[91m[1m| [0m[90m Bash     [0mCheck end of test file

  test('REF.08 - Referral link contains user code', async ({ page }) => {
    await loginUI(page, users.USER_IDFM.email, users.USER_IDFM.password);

    await page.goto('/referral');
    await page.waitForLoadState('networkidle');

    const code = page.locator(S.referral.code);
    const link = page.locator(S.referral.link);

    await expect(code).toBeVisible({ timeout: 10000 });
    await expect(link).toBeVisible({ timeout: 10000 });

    const codeText = await code.textContent();
    const linkHref = await link.getAttribute('href');

    expect(codeText).not.toBeNull();
    expect(linkHref).not.toBeNull();
    expect(linkHref).toContain(codeText);
  });
});

[96m[1m| [0m[90m Read     [0mveligo-platform/tests/e2e/fixtures/users.json
[91m[1m| [0m[90m Bash     [0mStart test database

 Container veligo-test  Recreate
 Container veligo-test  Recreated
 Container veligo-test  Starting
Error response from daemon: failed to set up container networking: driver failed programming external connectivity on endpoint veligo-test (53306b71d670e64af272e86d8c2169a3f2f6a47c5e70253e6bc452892823ab15): Bind for 0.0.0.0:8888 failed: port is already allocated

[91m[1m| [0m[90m Bash     [0mCheck running containers

857a0d361f7b   veligo2-veligo-dev       "/start-dev.sh"          5 days ago   Up 5 hours (healthy)    0.0.0.0:8888->8888/tcp, [::]:8888->8888/tcp, 0.0.0.0:8044->1025/tcp, [::]:8044->1025/tcp, 0.0.0.0:8040->5173/tcp, [::]:8040->5173/tcp, 0.0.0.0:8042->5432/tcp, [::]:8042->5432/tcp, 0.0.0.0:8043->6379/tcp, [::]:8043->6379/tcp, 0.0.0.0:8045->8025/tcp, [::]:8045->8025/tcp, 0.0.0.0:8041->50051/tcp, [::]:8041->50051/tcp   veligo-dev

[91m[1m| [0m[90m Bash     [0mTest database connection

psql: error: connection to server at "localhost" (::1), port 8042 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[91m[1m| [0m[90m Bash     [0mCheck all veligo containers

d6315a32da5b   veligo-platform-veligo-test   "/entrypoint.sh supeâ€¦"   23 seconds ago   Created                                                                                                                                                                                                                                                                                                                                                 veligo-test
857a0d361f7b   veligo2-veligo-dev            "/start-dev.sh"          5 days ago       Up 5 hours (healthy)      0.0.0.0:8888->8888/tcp, [::]:8888->8888/tcp, 0.0.0.0:8044->1025/tcp, [::]:8044->1025/tcp, 0.0.0.0:8040->5173/tcp, [::]:8040->5173/tcp, 0.0.0.0:8042->5432/tcp, [::]:8042->5432/tcp, 0.0.0.0:8043->6379/tcp, [::]:8043->6379/tcp, 0.0.0.0:8045->8025/tcp, [::]:8045->8025/tcp, 0.0.0.0:8041->50051/tcp, [::]:8041->50051/tcp   veligo-dev

[91m[1m| [0m[90m Bash     [0mTest database inside container

Error response from daemon: No such container: veligo2-veligo-dev

[91m[1m| [0m[90m Bash     [0mList veligo container names

veligo-dev

[91m[1m| [0m[90m Bash     [0mTest database inside veligo-dev

psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  Peer authentication failed for user "postgres"

[91m[1m| [0m[90m Bash     [0mCheck postgres user

postgres:x:102:105:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash

[91m[1m| [0m[90m Bash     [0mCheck postgres env vars
[96m[1m| [0m[90m Read     [0mveligo-platform/backend/.env.example
[91m[1m| [0m[90m Bash     [0mTest database with veligo user

psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  Peer authentication failed for user "veligo"

[91m[1m| [0m[90m Bash     [0mTry with su postgres

psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  database "veligo_dev" does not exist

[91m[1m| [0m[90m Bash     [0mList databases

                                List of databases
      Name      |  Owner   | Encoding | Collate |  Ctype  |   Access privileges   
----------------+----------+----------+---------+---------+-----------------------
 postgres       | postgres | UTF8     | C.UTF-8 | C.UTF-8 | 
 template0      | postgres | UTF8     | C.UTF-8 | C.UTF-8 | =c/postgres          +
                |          |          |         |         | postgres=CTc/postgres
 template1      | postgres | UTF8     | C.UTF-8 | C.UTF-8 | =c/postgres          +
                |          |          |         |         | postgres=CTc/postgres
 veligo_db      | veligo   | UTF8     | C.UTF-8 | C.UTF-8 | 
 veligo_test_db | veligo   | UTF8     | C.UTF-8 | C.UTF-8 | 
(5 rows)


[91m[1m| [0m[90m Bash     [0mTest veligo_db connection

 ?column? 
----------
        1
(1 row)


[91m[1m| [0m[90m Bash     [0mCopy migration to container
[91m[1m| [0m[90m Bash     [0mExecute migration

CREATE TABLE
CREATE TABLE
CREATE INDEX
CREATE INDEX
CREATE TABLE
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE TABLE
CREATE INDEX
CREATE INDEX
CREATE FUNCTION
psql:/tmp/102_referral_program.sql:86: NOTICE:  trigger "update_referral_program_config_updated_at" for relation "referral_program_config" does not exist, skipping
DROP TRIGGER
CREATE TRIGGER
psql:/tmp/102_referral_program.sql:92: NOTICE:  trigger "update_referrals_updated_at" for relation "referrals" does not exist, skipping
DROP TRIGGER
CREATE TRIGGER

[91m[1m| [0m[90m Bash     [0mCheck tenants

ERROR:  relation "tenants" does not exist
LINE 1: SELECT id, name FROM tenants LIMIT 5
                             ^

[91m[1m| [0m[90m Bash     [0mList tables

                  List of relations
 Schema |          Name           | Type  |  Owner   
--------+-------------------------+-------+----------
 public | referral_codes          | table | postgres
 public | referral_program_config | table | postgres
 public | referral_rewards        | table | postgres
 public | referrals               | table | postgres
(4 rows)


[91m[1m| [0m[90m Bash     [0mList first migrations

000_bootstrap.sql
001_init.sql
002_mfa_admin.sql
003_tracking_abeeway.sql
004_gdpr_compliance.sql
004_modules_catalog.sql.disabled
006_subscription_plans.sql
007_modules_complete.sql.disabled
007_subscriptions_plan_fk.sql
008_granular_modules.sql.disabled

[96m[1m| [0m[90m Read     [0mveligo-platform/backend/migrations/000_bootstrap.sql
[96m[1m| [0m[90m Read     [0mveligo-platform/backend/migrations/001_init.sql
[91m[1m| [0m[90m Bash     [0mCopy bootstrap migrations
[91m[1m| [0m[90m Bash     [0mExecute bootstrap migration

psql: error: /tmp/000_bootstrap.sql: Permission denied
