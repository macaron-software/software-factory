{% extends "base.html" %}

{% block content %}
<div class="tab-toolbar">
    {% with page_title="templates" %}{% include "partials/view_switcher.html" %}{% endwith %}
    <a href="/workflows/new" class="btn btn-primary btn-sm">
        <svg class="icon icon-sm"><use href="#icon-plus"/></svg> New
    </a>
</div>
<div class="item-grid" data-view-grid data-view="card">
    {% for wf in workflows %}
    <div class="item-card">
        <div class="item-icon">
            <svg class="icon icon-md" style="color:var(--purple)"><use href="#icon-{{ wf.icon }}"/></svg>
        </div>
        <div class="item-main">
            <div class="item-title">{{ wf.name }}</div>
            <div class="item-subtitle">{{ wf.phases | length }} phases</div>
            <div class="item-detail">
                <p class="item-desc">{{ wf.description }}</p>
                <div class="wf-mini-phases">
                    {% for phase in wf.phases %}
                    <span class="wf-mini-dot" title="{{ phase.name }}">{{ loop.index }}</span>
                    {% if not loop.last %}<span class="wf-mini-arrow">â†’</span>{% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="item-meta">
            {% if wf.is_builtin %}
            <span class="item-badge muted">{{ _("built_in") }}</span>
            {% endif %}
        </div>
        <div class="item-actions">
            <a href="/workflows/{{ wf.id }}/edit" class="btn btn-sm btn-ghost"><svg class="icon icon-xs"><use href="#icon-edit"/></svg></a>
            {% if wf.phases|length > 3 %}
            <a href="/missions/start/{{ wf.id }}" class="btn btn-sm btn-ghost" title="Mission Control"><svg class="icon icon-xs"><use href="#icon-play"/></svg></a>
            {% endif %}
            <a href="/sessions/new?workflow_id={{ wf.id }}" class="btn btn-sm btn-primary">{{ _("use") }}</a>
        </div>
    </div>
    {% endfor %}
    {% if not workflows %}
    <div class="empty-state"><p>{{ _("no_workflows_yet") }}</p></div>
    {% endif %}
</div>
{% endblock %}
