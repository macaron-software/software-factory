# Pentest Web â€” OWASP Top 10 Testing Methodology

## Checklist

### Injection (A03:2021)
- [ ] SQL Injection: UNION, blind, time-based, second-order
- [ ] NoSQL Injection: MongoDB operators ($gt, $ne, $regex)
- [ ] LDAP Injection: filter manipulation
- [ ] OS Command Injection: semicolons, pipes, backticks
- [ ] SSTI: template injection (Jinja2, Twig, Freemarker)

### Broken Authentication (A07:2021)
- [ ] Default credentials scan
- [ ] JWT manipulation: none algorithm, key confusion, expired tokens accepted
- [ ] Session fixation: session ID reuse after login
- [ ] Password policy bypass: min length, complexity
- [ ] Account lockout bypass: rate limiting, CAPTCHA

### XSS (A03:2021)
- [ ] Reflected XSS: URL params, search fields, error messages
- [ ] Stored XSS: comments, profiles, file uploads (SVG, HTML)
- [ ] DOM XSS: document.location, innerHTML, eval
- [ ] CSP bypass: dangling markup, script gadgets

### SSRF (A10:2021)
- [ ] Internal service access: http://localhost, http://127.0.0.1
- [ ] Cloud metadata: 169.254.169.254 (AWS/GCP/Azure)
- [ ] Protocol smuggling: file://, gopher://, dict://
- [ ] DNS rebinding

### IDOR / Broken Access Control (A01:2021)
- [ ] Horizontal privilege escalation: access other users' data
- [ ] Vertical privilege escalation: admin functions as regular user
- [ ] Parameter tampering: user_id, order_id in requests
- [ ] Missing function-level access control: direct URL access

### CSRF
- [ ] Missing CSRF tokens on state-changing requests
- [ ] SameSite cookie attribute verification
- [ ] Token validation bypass (remove token, empty token)

## Payload Templates

### SQLi Detection
```
' OR '1'='1' --
' UNION SELECT NULL,NULL,NULL --
' AND SLEEP(5) --
'; EXEC xp_cmdshell('whoami') --
```

### XSS Detection
```html
<script>alert(1)</script>
<img src=x onerror=alert(1)>
<svg/onload=alert(1)>
javascript:alert(1)
{{7*7}} (template injection)
```

### SSRF Detection
```
http://127.0.0.1:8080/admin
http://169.254.169.254/latest/meta-data/
http://[::1]/
http://0x7f000001/
```

## Anti-Patterns (REJECT if found in code)
- String concatenation in SQL queries
- innerHTML with user input
- eval() / exec() with user data
- requests.get(user_url) without URL validation
- open(user_path) without path traversal check
