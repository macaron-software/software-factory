id: tma-autoheal
name: TMA Auto-Heal
description: Tierce Maintenance Applicative â€” auto-diagnose and fix platform errors
icon: ðŸ”§
is_builtin: true
phases:
- id: diagnose
  pattern_id: hierarchical
  name: Diagnostic
  description: Analyze error logs, stack traces, and incident context to identify root cause
  gate: Root cause identified and documented
  config:
    agents:
    - brain
    - architecte
    - sre
- id: fix
  pattern_id: adversarial-pair
  name: Fix Implementation
  description: 'Implement the fix with TDD: write test â†’ fix code â†’ validate'
  gate: Fix implemented and all tests pass
  config:
    agents:
    - lead_dev
    - testeur
- id: verify
  pattern_id: sequential
  name: Verification
  description: Run regression tests, check no new incidents introduced
  gate: Zero regressions, fix verified in staging
  config:
    agents:
    - testeur
    - sre
- id: close
  pattern_id: solo
  name: Resolution
  description: Document fix, close incidents, update runbook if needed
  gate: Incidents resolved, knowledge base updated
  config:
    agents:
    - release_train_engineer
- id: integrate
  pattern_id: solo
  name: Integrate Fix
  description: >
    Push the fix branch to origin and create a Pull Request to main.
    Use git_push to push the current agent branch, then git_create_pr
    with title "TMA: <brief summary>" and base "main".
    If the project is the Software Factory itself, note the PR URL in the
    incident resolution so a human can review and merge.
  gate: PR created and linked to resolved incident
  config:
    agents:
    - release_train_engineer
config:
  autoheal: true
  max_duration_minutes: 30
  auto_rollback: true
  graph:
    nodes:
    - id: n1
      agent_id: brain
      x: 100
      y: 150
      label: Brain Diag
      phase: diagnose
    - id: n2
      agent_id: lead_dev
      x: 300
      y: 100
      label: Fix Dev
      phase: fix
    - id: n3
      agent_id: testeur
      x: 300
      y: 200
      label: QA Verify
      phase: fix
    - id: n4
      agent_id: sre
      x: 500
      y: 150
      label: SRE Verify
      phase: verify
    - id: n5
      agent_id: release_train_engineer
      x: 700
      y: 150
      label: RTE Close
      phase: close
    edges:
    - from: n1
      to: n2
      label: root cause
      color: '#ef4444'
    - from: n1
      to: n3
      label: test spec
      color: '#f97316'
    - from: n2
      to: n4
      label: fix
      color: '#3fb950'
    - from: n3
      to: n4
      label: test results
      color: '#3fb950'
    - from: n4
      to: n5
      label: verified
      color: '#58a6ff'
